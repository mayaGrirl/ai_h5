import{d as k,o as C,r as n,q as c,f as v,l as e,u as t,z as u,K as S,J as b,Q as B,R as E,x as h,B as R,v as d}from"./vue-vendor-ntQnFNWs.js";import{a as V,u as M,C as N,t as f}from"./index-CxBbivxG.js";import{e as z}from"./customer-CxyYchvQ.js";import{_ as A}from"./PageHeader.vue_vue_type_script_setup_true_lang-C1O_2GF7.js";import"./utils-vendor-CbLx3nH2.js";import"./index-C6jzfBHC.js";import"./chevron-left-GwUV-0el.js";const D={class:"min-h-screen bg-[#f5f7fb] pb-16"},$={class:"px-3 pb-20 pt-3"},q={class:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2"},I={class:"text-red-600 text-sm"},J={class:"bg-white rounded-xl shadow-sm p-3"},K={class:"flex items-center gap-2"},Q={class:"text-gray-700 w-12 flex-shrink-0"},T=["placeholder","disabled"],U={key:0,class:"mt-1 text-xs text-red-500"},j=["disabled"],Y=k({__name:"bind-email",setup(F){const _=R(),{t:a}=V(),p=M(),s=n(""),r=n(""),l=n(!1),i=n(!1),x=o=>/^[\w\-\.]+@[\w\-]+(\.\w+)+$/.test(o),g=()=>(r.value="",s.value.trim()?x(s.value)?s.value.length>50?(r.value="邮箱最多50个字符",!1):!0:(r.value="邮箱格式不正确",!1):(r.value="请输入邮箱",!1)),w=async()=>{if(g()){l.value=!0;try{const o=await z({email:s.value});o.code===200?(f.success(o.message||"绑定成功"),_.back()):f.error(o.message||"绑定失败")}catch{f.error("绑定失败")}finally{l.value=!1}}};return C(()=>{p.currentCustomer?.email&&(s.value=p.currentCustomer.email,i.value=!0)}),(o,m)=>(d(),c("div",D,[v(A,{title:t(a)("mine.bind-email.title")},null,8,["title"]),e("main",$,[e("div",q,[v(t(N),{class:"w-5 h-5 text-red-500 flex-shrink-0"}),e("span",I,u(t(a)("mine.bind-email.alert")),1)]),e("form",{onSubmit:S(w,["prevent"]),class:"mt-5"},[e("div",J,[e("div",K,[e("label",Q,u(t(a)("mine.profile.form-label.email")),1),B(e("input",{"onUpdate:modelValue":m[0]||(m[0]=y=>s.value=y),type:"text",placeholder:t(a)("common.form.placeholder.enter")+t(a)("mine.profile.form-label.email"),disabled:i.value,class:h(["flex-1 placeholder-gray-400 focus:outline-none h-12",i.value?"text-gray-400":"text-gray-800"])},null,10,T),[[E,s.value]])]),r.value?(d(),c("p",U,u(r.value),1)):b("",!0)]),i.value?b("",!0):(d(),c("button",{key:0,type:"submit",disabled:l.value,class:h(["mt-10 h-12 w-full rounded-full bg-gradient-to-r from-[#ff6a3a] to-[#ff1020] text-white font-medium tracking-wide transition transform active:scale-95",l.value?"opacity-60 cursor-not-allowed":"cursor-pointer"])},u(l.value?t(a)("common.form.button.submitting"):t(a)("common.form.button.submit")),11,j))],32)])]))}});export{Y as default};
