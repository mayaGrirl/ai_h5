import{d as I,o as M,q as r,r as f,l as s,F as k,t as C,z as h,u as y,I as P,B as q,v as o,x as G}from"./vue-vendor-ntQnFNWs.js";import{g as F,p as R}from"./game-DANEdZjg.js";import{t as p}from"./index-BvHA6CJ8.js";import{u as T}from"./useLocalized-C2qZMYyo.js";import"./utils-vendor-CbLx3nH2.js";import"./index-C6jzfBHC.js";const D={key:0,class:"flex min-h-screen justify-center items-center bg-zinc-50"},E={key:1,class:"flex min-h-screen justify-center items-center bg-zinc-50"},N={key:2,class:"flex min-h-screen justify-center bg-zinc-50"},V={class:"w-full max-w-3xl bg-white"},H={class:"w-full overflow-x-auto whitespace-nowrap border-b py-3 px-4 bg-red-50"},J={class:"flex gap-4"},K=["onClick"],O={class:"flex"},Q={class:"w-28 border-r p-3 flex flex-col gap-3 bg-gray-50 min-h-[70vh]"},U=["onClick"],W={class:"flex-1 p-4"},X={class:"text-lg font-bold mb-3"},Y={key:0,class:"flex justify-center items-center py-8"},Z={key:1,class:"text-center py-8 text-gray-500"},ee={key:2,class:"grid grid-cols-2 gap-3"},te=["onClick"],se={class:"font-medium"},ce=I({__name:"index",setup(le){const{localize:_}=T(),S=P(),j=q(),A=f([]),g=f(null),d=f(null),m=f([]),b=f(!0),x=f(!1),z=async()=>{try{b.value=!0;const l=S.query.lottery_id,e=await F({});if(e.code===200&&e.data){const{gameTypeMap:t=[]}=e.data,c=(Array.isArray(t)?t:[]).filter(n=>n.children&&Array.isArray(n.children)&&n.children.length>0).map(n=>{const v=n.children.filter(a=>a.is_show===void 0||a.is_show===1).map(a=>({id:a.id,name:a.name,logo:a.logo,lang_name:a.lang_name,game_class:a.game_class,is_hot:a.is_hot,is_show:a.is_show,info:a.info,lang_info:a.lang_info}));return{id:n.id,name:n.title,lang_title:n.lang_title,games:v}}).filter(n=>n.games.length>0);A.value=c;let i=null,u=null;if(l)for(const n of c){const v=n.games.find(a=>String(a.id)===String(l));if(v){i=n,u=v;break}}i||(i=c[0]),u||(u=i?.games[0]||null),g.value=i,d.value=u,u&&await w(u.id)}else p.error(e.message||"获取游戏列表失败")}catch{p.error("获取游戏列表失败，请稍后重试")}finally{b.value=!1}},w=async l=>{try{x.value=!0;const e=await R({lottery_id:l});if(e.code===200&&e.data){const{groupArr:t=[]}=e.data,c=t.filter(i=>i.status===1).map(i=>({id:i.id,name:i.name,lang_name:i.lang_name}));m.value=c}else p.error(e.message||"获取玩法分组失败"),m.value=[]}catch{p.error("获取玩法分组失败，请稍后重试"),m.value=[]}finally{x.value=!1}},L=l=>{if(g.value=l,l.games.length>0){const e=l.games[0];d.value=e,w(e.id)}},$=l=>{d.value=l,w(l.id)},B=l=>{d.value&&j.push(`/games/play?lottery_id=${d.value.id}&group_id=${l}`)};return M(()=>{z()}),(l,e)=>b.value?(o(),r("div",D,[...e[0]||(e[0]=[s("div",{class:"text-center"},[s("div",{class:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-red-600 border-r-transparent"}),s("p",{class:"mt-3 text-gray-600"},"加载游戏列表中...")],-1)])])):!g.value||!d.value?(o(),r("div",E,[s("div",{class:"text-center"},[e[1]||(e[1]=s("p",{class:"text-gray-600"},"暂无游戏数据",-1)),s("button",{onClick:z,class:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg"}," 重新加载 ")])])):(o(),r("div",N,[s("main",V,[e[3]||(e[3]=s("header",{class:"h-16 flex items-center justify-center bg-red-600 text-white"},[s("span",{class:"text-white text-2xl font-black tracking-wide"},"游戏大厅")],-1)),s("div",H,[s("div",J,[(o(!0),r(k,null,C(A.value,t=>(o(),r("button",{key:t.id,onClick:c=>L(t),class:G(["px-4 py-2 rounded-full text-sm",g.value?.id===t.id?"bg-red-600 text-white":"bg-white text-red-600 border border-red-600"])},h(y(_)(t.lang_title,t.name)),11,K))),128))])]),s("div",O,[s("div",Q,[(o(!0),r(k,null,C(g.value?.games,t=>(o(),r("button",{key:t.id,onClick:c=>$(t),class:G(["text-sm p-2 rounded",d.value?.id===t.id?"bg-blue-600 text-white":"bg-blue-50 text-blue-600"])},h(y(_)(t.lang_name,t.name)),11,U))),128))]),s("div",W,[s("h2",X,h(d.value?y(_)(d.value.lang_name,d.value.name):""),1),x.value?(o(),r("div",Y,[...e[2]||(e[2]=[s("div",{class:"inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"},null,-1),s("span",{class:"ml-2 text-gray-600"},"加载玩法分组中...",-1)])])):m.value.length===0?(o(),r("div",Z," 暂无玩法分组数据 ")):(o(),r("div",ee,[(o(!0),r(k,null,C(m.value,t=>(o(),r("button",{key:t.id,onClick:c=>B(t.id),class:"p-4 bg-gray-100 rounded-lg text-center text-gray-900 hover:bg-gray-200 transition cursor-pointer"},[s("div",se,h(y(_)(t.lang_name,t.name)),1)],8,te))),128))]))])])])]))}});export{ce as default};
