import{d as D,w as M,o as z,L as F,D as I,c as $,q as o,f as E,n as e,y as S,F as q,t as L,C as x,N as d,x as l,r as c,u as N,Q,l as n}from"./vue-vendor-2ZNhN7Rr.js";import{a as T,t as b}from"./index-CL3zLPQY.js";import{k as A,l as G,m as H}from"./customer-BiAoQat5.js";import{_ as J}from"./PageHeader.vue_vue_type_script_setup_true_lang-BqWK2P6g.js";import"./utils-vendor-CbLx3nH2.js";import"./index-C6jzfBHC.js";import"./chevron-left-8uYLpLhl.js";const O={class:"min-h-screen bg-[#f5f7fb] pb-16"},P={class:"grid grid-cols-3 text-center text-sm bg-white"},U=["onClick"],W={class:"p-2"},X={key:0,class:"px-4 py-4 bg-white rounded-lg"},Y={class:"mb-3"},Z={class:"bg-[#f5f5f5] py-3 px-3 rounded text-sm"},tt={class:"text-red-600 font-semibold"},et={class:"text-red-600 font-semibold"},st={class:"text-red-600 font-semibold"},at={class:"bg-[#fffae8] text-[#f79304] py-3 px-3 my-3 rounded text-sm"},it={class:"flex justify-center py-20"},ot={key:1,class:"px-4 py-4 bg-white rounded-lg"},lt={key:2,class:"bg-white rounded-lg"},nt={key:0,class:"flex justify-center items-center py-8"},rt={key:1,class:"text-center py-8 text-gray-500"},dt={key:2,class:"divide-y"},ct={class:"text-sm text-gray-800"},ut={class:"text-xs text-gray-500 mt-1"},vt={class:"text-right"},yt={class:"text-sm text-red-600"},_t={class:"text-xs text-orange-500"},ft={key:0,class:"py-4 text-center"},pt=["disabled"],gt={key:1,class:"py-4 text-center text-gray-400 text-sm"},R=20,qt=D({__name:"index",setup(mt){const g=F(),h=I(),{t:k}=T(),u=$(()=>g.query.tab||"in"),V=[{key:"in",i18Key:"mine.sign-in.tab-1"},{key:"intro",i18Key:"mine.sign-in.tab-2"},{key:"record",i18Key:"mine.sign-in.tab-3"}],j=a=>{h.replace({query:{tab:a}})},y=c(!1),_=c(!1),i=c(),w=async()=>{try{const{data:a}=await A();i.value=a,a.is_sign&&(y.value=!0)}catch(a){console.error("获取签到数据失败",a)}},K=async()=>{if(!y.value){_.value=!0;try{const{code:a,message:t,data:s}=await G();a===200?(b.success(t||"签到成功"),i.value&&(i.value={total_people:i.value.total_people+1,total_points:i.value.total_points+s.total_points,total_base_coin:i.value.total_base_coin+s.total_base_coin,continue_days:i.value.continue_days+1,total_days:i.value.total_days+1,is_sign:!0}),y.value=!0):b.error(t||"签到失败")}catch{b.error("签到失败")}finally{_.value=!1}}},r=c([]),v=c(!1),C=c(1),f=c(!0),m=async(a=1,t=!1)=>{try{v.value=!0;const s=await H({page:a,pageSize:R});if(s.code===200&&s.data){const p=s.data||[];t?r.value=p:r.value=[...r.value,...p],f.value=p.length>=R,C.value=a}}catch(s){console.error("加载签到记录失败",s)}finally{v.value=!1}},B=()=>{v.value||!f.value||m(C.value+1,!1)};return M(()=>g.query.tab,a=>{a==="in"||!a?w():a==="record"&&m(1,!0)}),z(()=>{g.query.tab||h.replace({query:{tab:"in"}}),u.value==="in"?w():u.value==="record"&&m(1,!0)}),(a,t)=>(n(),o("div",O,[E(J,{title:S(k)("mine.btn-sign_in")},null,8,["title"]),e("div",P,[(n(),o(q,null,L(V,s=>e("button",{key:s.key,onClick:p=>j(s.key),class:N(["py-3 text-center transition-colors",u.value===s.key?"text-red-500 font-bold border-b-2 border-red-500":"text-gray-500 hover:text-gray-700"])},l(S(k)(s.i18Key)),11,U)),64))]),e("div",W,[u.value==="in"?(n(),o("div",X,[e("div",Y,[e("div",Z,[t[0]||(t[0]=d(" 今日已有 ",-1)),e("span",tt,l(i.value?.total_people||0),1),t[1]||(t[1]=d(" 人签到， 共获得 ",-1)),e("span",et,l(i.value?.total_points||0),1),t[2]||(t[2]=d(" 积分， ",-1)),e("span",st,l(i.value?.total_base_coin||0),1),t[3]||(t[3]=d(" 金豆 ",-1))]),e("div",at,[t[4]||(t[4]=d(" 您已连续签到 ",-1)),e("strong",null,l(i.value?.continue_days||0),1),t[5]||(t[5]=d(" 天， 累计签到 ",-1)),e("strong",null,l(i.value?.total_days||0),1),t[6]||(t[6]=d(" 天 ",-1))])]),e("div",it,[e("button",{type:"button",onClick:K,class:N(["w-40 h-40 rounded-full flex items-center justify-center text-white text-lg font-medium shadow-lg transition-transform active:scale-95",y.value||_.value?"bg-[#cccccc]":"bg-[#ff5a1f]"])},l(y.value?"已签到":_.value?"签到中...":"点击签到"),3)])])):u.value==="intro"?(n(),o("div",ot,[...t[7]||(t[7]=[Q('<div class="space-y-4 text-sm text-gray-700"><div><h3 class="font-medium text-gray-900 mb-2">签到规则</h3><ul class="list-disc list-inside space-y-1 text-gray-600"><li>每日签到可获得积分和金豆奖励</li><li>连续签到天数越多，奖励越丰厚</li><li>每日0点重置签到状态</li><li>中断签到后，连续签到天数重新计算</li></ul></div><div><h3 class="font-medium text-gray-900 mb-2">奖励说明</h3><ul class="list-disc list-inside space-y-1 text-gray-600"><li>基础签到奖励：每日固定积分</li><li>连续签到奖励：额外积分加成</li><li>金豆奖励：可用于游戏投注</li></ul></div></div>',1)])])):u.value==="record"?(n(),o("div",lt,[v.value&&r.value.length===0?(n(),o("div",nt,[...t[8]||(t[8]=[e("div",{class:"inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"},null,-1),e("span",{class:"ml-2 text-gray-600"},"加载中...",-1)])])):r.value.length===0?(n(),o("div",rt," 暂无签到记录 ")):(n(),o("div",dt,[(n(!0),o(q,null,L(r.value,s=>(n(),o("div",{key:s.id,class:"px-4 py-3 flex justify-between items-center"},[e("div",null,[e("div",ct,l(s.sign_date),1),e("div",ut,l(s.created_at),1)]),e("div",vt,[e("div",yt,"+"+l(s.reward_points)+" 积分",1),e("div",_t,"+"+l(s.reward_base_coin)+" 金豆",1)])]))),128)),f.value?(n(),o("div",ft,[e("button",{onClick:B,disabled:v.value,class:"px-6 py-2 bg-red-600 text-white text-sm rounded-lg disabled:opacity-50"},l(v.value?"加载中...":"加载更多"),9,pt)])):x("",!0),!f.value&&r.value.length>0?(n(),o("div",gt," 没有更多数据了 ")):x("",!0)]))])):x("",!0)])]))}});export{qt as default};
