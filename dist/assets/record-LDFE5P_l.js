import{_ as y}from"./coin-BjeO1Yvx.js";import{d as B,w as I,o as F,b as M,q as d,l as e,f as R,u as a,J as b,z as s,F as V,t as L,r as u,B as P,v as f,L as w,P as T}from"./vue-vendor-ntQnFNWs.js";import{a as D,t as k}from"./index-DWbiG9GH.js";import{d as O}from"./customer-93-uEbFQ.js";import{C as q}from"./chevron-left-CCZzeuyU.js";import"./utils-vendor-CbLx3nH2.js";const E={class:"flex min-h-screen justify-center bg-[#eef3f8]"},J={class:"w-full max-w-xl bg-[#f5f7fb] shadow-sm"},S={class:"sticky top-0 z-40 bg-gradient-to-r from-red-600 to-red-500"},U={class:"flex h-12 items-center justify-between px-3"},Y={class:"p-2"},$={class:"grid grid-cols-[1fr_1fr_1fr] px-3 py-2 text-xs text-gray-500 border-b bg-white"},A={class:"text-center"},G={class:"text-right"},H={class:"flex justify-start items-center gap-1 font-medium"},K={class:"text-center font-medium"},Q={class:"text-red-500 flex items-center text-center justify-center"},W={class:"text-xs"},X={class:"flex flex-col items-end font-medium"},Z={class:"text-red-500 flex items-center text-center justify-center"},ee={class:"text-xs"},te={key:1,class:"py-4 text-center text-xs text-gray-400"},ce=B({__name:"record",setup(se){const C=P(),{t:i}=D(),l=u([]),p=u(1),c=u(!0),m=u(!1),x=u(null);let r=null;const N=()=>{r&&(r.disconnect(),r=null),!(!c.value||!x.value)&&(r=new IntersectionObserver(([o])=>{if(o.isIntersecting&&!m.value&&c.value){const t=p.value+1;p.value=t,g(t)}},{threshold:.1}),r.observe(x.value))},_=o=>new Intl.NumberFormat("zh-CN").format(o),h=o=>new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY"}).format(o),g=async o=>{m.value=!0;try{const{code:t,data:n,message:v}=await O({search:{type:14},pagination:{page:o,size:20}});await new Promise(z=>setTimeout(z,554)),t===200?(n.length<20&&(c.value=!1),o===1&&(l.value=[]),l.value=[...l.value,...n]):k.error(v)}catch{k.error("获取数据失败")}finally{m.value=!1}};I(l,()=>{T(()=>{N()})}),F(()=>{g(1)}),M(()=>{r&&(r.disconnect(),r=null)});const j=()=>{C.back()};return(o,t)=>(f(),d("div",E,[e("div",J,[e("header",S,[e("div",U,[e("button",{onClick:j,class:"flex items-center text-white"},[R(a(q),{class:"h-5 w-5"})]),t[0]||(t[0]=e("span",{class:"text-white font-bold"},"兑换记录",-1)),t[1]||(t[1]=e("div",{class:"w-5"},null,-1))])]),e("div",Y,[e("div",$,[e("div",null,s(a(i)("shop.record-grid-1")),1),e("div",A,s(a(i)("shop.record-grid-2")),1),e("div",G,s(a(i)("shop.record-grid-3")),1)]),(f(!0),d(V,null,L(l.value,(n,v)=>(f(),d("div",{key:`all-key-${v}`,class:"grid grid-cols-[1fr_1fr_1fr] px-3 py-1 border-b items-center bg-white"},[e("div",H,s(n?.created_at),1),e("div",K,[e("div",Q,[w(s(_(n.deposit??0))+" ",1),t[2]||(t[2]=e("img",{src:y,alt:"coin",class:"inline-block w-[13px] h-[13px]"},null,-1))]),e("div",W,s(h((n.deposit??0)/1e3)),1)]),e("div",X,[e("div",Z,[w(s(_(n.a_deposit??0))+" ",1),t[3]||(t[3]=e("img",{src:y,alt:"coin",class:"inline-block w-[13px] h-[13px]"},null,-1))]),e("div",ee,s(h((n.a_deposit??0)/1e3)),1)])]))),128)),c.value?(f(),d("div",{key:0,ref_key:"loadMoreRef",ref:x,class:"py-4 text-center text-xs text-gray-400"},s(m.value?a(i)("common.loading"):a(i)("common.loading-hit")),513)):b("",!0),c.value?b("",!0):(f(),d("div",te,s(a(i)("common.loading-list-empty")),1))]),t[4]||(t[4]=e("div",{class:"h-14"},null,-1))])]))}});export{ce as default};
