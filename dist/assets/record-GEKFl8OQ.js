import{_ as y}from"./coin-BjeO1Yvx.js";import{d as R,w as z,o as B,b as F,q as d,n as e,f as M,y as a,C as b,x as s,F as V,t as D,r as u,D as T,l as f,N as w,R as L}from"./vue-vendor-2ZNhN7Rr.js";import{a as O,t as k}from"./index-CL3zLPQY.js";import{d as P}from"./customer-BiAoQat5.js";import{C as q}from"./chevron-left-8uYLpLhl.js";import"./utils-vendor-CbLx3nH2.js";const E={class:"flex min-h-screen justify-center bg-[#eef3f8]"},S={class:"w-full max-w-xl bg-[#f5f7fb] shadow-sm"},U={class:"sticky top-0 z-40 bg-gradient-to-r from-red-600 to-red-500"},Y={class:"flex h-12 items-center justify-between px-3"},$={class:"p-2"},A={class:"grid grid-cols-[1fr_1fr_1fr] px-3 py-2 text-xs text-gray-500 border-b bg-white"},G={class:"text-center"},H={class:"text-right"},J={class:"flex justify-start items-center gap-1 font-medium"},K={class:"text-center font-medium"},Q={class:"text-red-500 flex items-center text-center justify-center"},W={class:"text-xs"},X={class:"flex flex-col items-end font-medium"},Z={class:"text-red-500 flex items-center text-center justify-center"},ee={class:"text-xs"},te={key:1,class:"py-4 text-center text-xs text-gray-400"},ce=R({__name:"record",setup(se){const C=T(),{t:i}=O(),l=u([]),v=u(1),c=u(!0),m=u(!1),x=u(null);let r=null;const N=()=>{r&&(r.disconnect(),r=null),!(!c.value||!x.value)&&(r=new IntersectionObserver(([o])=>{if(o.isIntersecting&&!m.value&&c.value){const t=v.value+1;v.value=t,g(t)}},{threshold:.1}),r.observe(x.value))},_=o=>new Intl.NumberFormat("zh-CN").format(o),h=o=>new Intl.NumberFormat("zh-CN",{style:"currency",currency:"CNY"}).format(o),g=async o=>{m.value=!0;try{const{code:t,data:n,message:p}=await P({search:{type:14},pagination:{page:o,size:20}});await new Promise(I=>setTimeout(I,554)),t===200?(n.length<20&&(c.value=!1),o===1&&(l.value=[]),l.value=[...l.value,...n]):k.error(p)}catch{k.error("获取数据失败")}finally{m.value=!1}};z(l,()=>{L(()=>{N()})}),B(()=>{g(1)}),F(()=>{r&&(r.disconnect(),r=null)});const j=()=>{C.back()};return(o,t)=>(f(),d("div",E,[e("div",S,[e("header",U,[e("div",Y,[e("button",{onClick:j,class:"flex items-center text-white"},[M(a(q),{class:"h-5 w-5"})]),t[0]||(t[0]=e("span",{class:"text-white font-bold"},"兑换记录",-1)),t[1]||(t[1]=e("div",{class:"w-5"},null,-1))])]),e("div",$,[e("div",A,[e("div",null,s(a(i)("shop.record-grid-1")),1),e("div",G,s(a(i)("shop.record-grid-2")),1),e("div",H,s(a(i)("shop.record-grid-3")),1)]),(f(!0),d(V,null,D(l.value,(n,p)=>(f(),d("div",{key:`all-key-${p}`,class:"grid grid-cols-[1fr_1fr_1fr] px-3 py-1 border-b items-center bg-white"},[e("div",J,s(n?.created_at),1),e("div",K,[e("div",Q,[w(s(_(n.deposit??0))+" ",1),t[2]||(t[2]=e("img",{src:y,alt:"coin",class:"inline-block w-[13px] h-[13px]"},null,-1))]),e("div",W,s(h((n.deposit??0)/1e3)),1)]),e("div",X,[e("div",Z,[w(s(_(n.a_deposit??0))+" ",1),t[3]||(t[3]=e("img",{src:y,alt:"coin",class:"inline-block w-[13px] h-[13px]"},null,-1))]),e("div",ee,s(h((n.a_deposit??0)/1e3)),1)])]))),128)),c.value?(f(),d("div",{key:0,ref_key:"loadMoreRef",ref:x,class:"py-4 text-center text-xs text-gray-400"},s(m.value?a(i)("common.loading"):a(i)("common.loading-hit")),513)):b("",!0),c.value?b("",!0):(f(),d("div",te,s(a(i)("common.loading-list-empty")),1))]),t[4]||(t[4]=e("div",{class:"h-14"},null,-1))])]))}});export{ce as default};
