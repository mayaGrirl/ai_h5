import{d as T,w as V,o as D,q as r,l as e,k as P,f as m,u as h,r as d,J as b,F,t as E,z as c,K as R,p as S,B as G,I as H,v as l}from"./vue-vendor-ntQnFNWs.js";import{m as J,s as K}from"./game-qbYhjhVu.js";import{c as w,t as k}from"./index-CFMypmBh.js";import"./utils-vendor-CbLx3nH2.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=w("PenIcon",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=w("PlusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=w("Trash2Icon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),U={class:"bg-gray-100 pb-16"},W={class:"bg-white mx-3 my-3 rounded-lg shadow"},X={class:"bg-white mx-3 my-3 rounded-lg shadow"},Y={key:0,class:"flex justify-center items-center py-8"},Z={key:1,class:"text-center py-8 text-gray-500"},ee={key:2,class:"divide-y"},te={class:"grid grid-cols-[1fr_80px_80px] items-center gap-2"},se={class:"font-medium text-gray-800 truncate"},oe={class:"text-center text-red-600 font-medium"},ae={class:"flex justify-center gap-1"},le=["onClick"],re=["onClick"],ne={class:"mt-2 text-xs text-gray-500"},ie={class:"flex items-start gap-1"},de={class:"line-clamp-2 break-all"},ce={class:"flex items-start gap-1 mt-1"},ue={class:"line-clamp-1 break-all"},ge={key:0,class:"py-4 text-center"},pe=["disabled"],ye={key:1,class:"py-4 text-center text-gray-400 text-sm"},ve={class:"mx-4 w-full max-w-sm rounded-lg bg-white p-4"},fe={class:"text-gray-600 mb-4"},_e={class:"flex gap-3"},N=20,we=T({__name:"mode",setup(xe){const p=H(),C=G(),a=d([]),n=d(!1),I=d(1),y=d(!0),u=d(!1),i=d(null),v=()=>Number(p.query.lottery_id)||0,M=()=>Number(p.query.group_id)||0,$=s=>{const t=typeof s=="string"?parseInt(s,10):s;return isNaN(t)?"0":new Intl.NumberFormat("zh-CN").format(t)},f=async(s=1,t=!1)=>{const o=v(),_=M();if(o)try{n.value=!0;const g=await J({lottery_id:o,game_group_id:_,page:s,pageSize:N});if(g.code===200&&g.data){const x=g.data.list||[];t?a.value=x:a.value=[...a.value,...x],y.value=x.length>=N,I.value=s}else t&&(a.value=[])}catch(g){console.error("获取模式列表失败:",g),t&&(a.value=[])}finally{n.value=!1}},z=()=>{n.value||!y.value||f(I.value+1,!1)},L=async()=>{if(i.value)try{const s=await K({id:i.value.id,status:0});s.code===200?(k.success("删除成功"),a.value=a.value.filter(t=>t.id!==i.value?.id)):k.error(s.message||"删除失败")}catch{k.error("删除失败，请稍后重试")}finally{u.value=!1,i.value=null}},j=s=>{i.value=s,u.value=!0},q=()=>{const s=v(),t=M();C.push(`/games/mode/edit?lottery_id=${s}&group_id=${t}`)},B=s=>{const t=v();C.push(`/games/mode/edit?lottery_id=${t}&group_id=${s.game_group_id}&mode_id=${s.id}`)};return V(()=>[p.query.lottery_id,p.query.group_id],()=>{f(1,!0)}),D(()=>{f(1,!0)}),(s,t)=>(l(),r("div",U,[e("div",W,[e("button",{onClick:q,class:"w-full flex items-center justify-center gap-2 py-4 text-red-600 hover:bg-red-50"},[m(h(O),{size:20}),t[2]||(t[2]=e("span",null,"创建新模式",-1))])]),e("div",X,[t[6]||(t[6]=e("div",{class:"grid grid-cols-[1fr_80px_80px] text-xs text-gray-500 border-b bg-gray-50 px-3 py-2 gap-2 rounded-t-lg"},[e("span",null,"模式名称"),e("span",{class:"text-center"},"总金豆"),e("span",{class:"text-center"},"操作")],-1)),n.value&&a.value.length===0?(l(),r("div",Y,[...t[3]||(t[3]=[e("div",{class:"inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"},null,-1),e("span",{class:"ml-2 text-gray-600"},"加载模式列表中...",-1)])])):a.value.length===0?(l(),r("div",Z," 暂无模式，点击上方按钮创建 ")):(l(),r("div",ee,[(l(!0),r(F,null,E(a.value,o=>(l(),r("div",{key:o.id,class:"px-3 py-3 text-sm bg-white hover:bg-gray-50"},[e("div",te,[e("div",se,c(o.mode_name),1),e("div",oe,c($(o.bet_gold)),1),e("div",ae,[e("button",{onClick:_=>B(o),class:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:"编辑"},[m(h(A),{size:16})],8,le),e("button",{onClick:_=>j(o),class:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:"删除"},[m(h(Q),{size:16})],8,re)])]),e("div",ne,[e("div",ie,[t[4]||(t[4]=e("span",{class:"text-gray-400 flex-shrink-0"},"玩法:",-1)),e("span",de,c(o.bet_no),1)]),e("div",ce,[t[5]||(t[5]=e("span",{class:"text-gray-400 flex-shrink-0"},"金豆:",-1)),e("span",ue,c(o.bet_no_gold),1)])])]))),128)),y.value?(l(),r("div",ge,[e("button",{onClick:z,disabled:n.value,class:"px-6 py-2 bg-red-600 text-white text-sm rounded-lg disabled:opacity-50"},c(n.value?"加载中...":"加载更多"),9,pe)])):b("",!0),!y.value&&a.value.length>0?(l(),r("div",ye," 没有更多数据了 ")):b("",!0)]))]),(l(),P(S,{to:"body"},[u.value?(l(),r("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:t[1]||(t[1]=R(o=>u.value=!1,["self"]))},[e("div",ve,[t[7]||(t[7]=e("div",{class:"text-lg font-medium mb-2"},"确认删除",-1)),e("div",fe,' 确定要删除模式 "'+c(i.value?.mode_name)+'" 吗？ ',1),e("div",_e,[e("button",{onClick:t[0]||(t[0]=o=>u.value=!1),class:"flex-1 py-2 bg-gray-200 text-gray-700 rounded-lg"}," 取消 "),e("button",{onClick:L,class:"flex-1 py-2 bg-red-600 text-white rounded-lg"}," 确认删除 ")])])])):b("",!0)]))]))}});export{we as default};
