import{_ as D}from"./coin-BjeO1Yvx.js";import{d as H,w as I,o as E,L as F,D as P,c as A,q as l,f as G,n as e,y as a,F as h,t as x,C as R,r as d,x as r,u as w,l as i,N as J}from"./vue-vendor-2ZNhN7Rr.js";import{a as O,t as k}from"./index-CIZoSaJ3.js";import{n as Q,o as U,p as W}from"./customer-CDJyDjhM.js";import{g as X}from"./common-PQj6D7Hk.js";import{_ as Y}from"./PageHeader.vue_vue_type_script_setup_true_lang-BnPQ6QDM.js";import"./utils-vendor-CbLx3nH2.js";import"./index-C6jzfBHC.js";import"./chevron-left-DCF22wfj.js";const Z={class:"min-h-screen bg-[#f5f7fb] pb-16"},ee={class:"grid grid-cols-3 text-center text-sm bg-white"},te=["onClick"],oe={class:"p-2"},re={key:0,class:"px-4 py-4 bg-white rounded-lg"},se=["innerHTML"],ae={class:"overflow-hidden rounded-lg bg-white shadow-sm"},ne={class:"grid grid-cols-4 bg-[#fafafa] px-3 py-2 font-medium text-center text-gray-700 text-sm"},le={class:"flex justify-center items-center gap-1"},ie=["src","alt"],ce={class:"flex justify-center items-center gap-1 text-orange-500 font-medium"},de={key:1,class:"px-4 py-4 bg-white rounded-lg"},ue={class:"mb-2 text-lg font-bold text-gray-800"},me={class:"mb-3 text-sm text-gray-600"},ve=["value"],fe=["disabled"],pe={key:2,class:"bg-white rounded-lg"},ge={class:"grid grid-cols-2 gap-2 px-3 py-2"},ye=["disabled"],_e=["disabled"],be={class:"grid grid-cols-[0.5fr_1fr_1fr_1fr] px-3 py-2 text-xs text-gray-500 border-b bg-[#cccccc]"},he={class:"text-center"},xe={class:"text-center"},we={class:"text-center"},ke={class:"text-center"},Ce={key:0,class:"flex justify-center items-center py-8"},Le={class:"ml-2 text-gray-600"},$e={key:1,class:"text-center py-8 text-gray-500"},Re={key:2},qe={class:"leading-tight"},Be={class:"text-center font-medium"},Te={class:"text-center font-medium"},ze={class:"text-center font-medium"},Ke={key:0,class:"py-4 text-center"},Me=["disabled"],Ne={key:1,class:"py-4 text-center text-gray-400 text-sm"},Ge=H({__name:"index",setup(Se){const C=F(),q=P(),{t:s}=O(),u=A(()=>C.query.tab||"intro"),N=[{key:"intro",i18Key:"recommend.tab-1"},{key:"promotion",i18Key:"recommend.tab-2"},{key:"record",i18Key:"recommend.tab-3"}],S=t=>{q.replace({query:{tab:t}})},B=d(""),L=d(!1),V=[{level:0,eco:0,reward:0,rate:"0.2%"},{level:1,eco:500,reward:1e4,rate:"0.2%"},{level:2,eco:2e3,reward:3e4,rate:"0.2%"},{level:3,eco:1e4,reward:8e4,rate:"0.2%"},{level:4,eco:6e4,reward:16e4,rate:"0.2%"},{level:5,eco:42e4,reward:3e5,rate:"0.2%"},{level:6,eco:8e5,reward:5e5,rate:"0.2%"},{level:7,eco:2e6,reward:6e5,rate:"0.2%"},{level:8,eco:8e6,reward:7e5,rate:"0.2%"},{level:9,eco:15e6,reward:8e5,rate:"0.2%"},{level:10,eco:3e7,reward:9e5,rate:"0.2%"}],T=async()=>{L.value=!0;try{const t=await X("customer_spread_intro_tips");t.code===200&&t.data&&(B.value=t.data.content||"")}catch(t){console.error("加载推广说明失败",t)}finally{L.value=!1}},g=d(!1),_=d(""),v=d(!1),z=async()=>{g.value=!0;try{const t=await Q();if(t.code===200&&t.data){const o=`${`${window.location.protocol}//${window.location.host}`}/auth/register?t=${t.data.key}`;_.value=s("recommend.copied-text",{link:o})}else k.error(t.message||"获取推广链接失败")}catch(t){console.error("获取推广链接失败",t)}finally{g.value=!1}},j=async()=>{try{await navigator.clipboard.writeText(_.value),v.value=!0,setTimeout(()=>{v.value=!1},1500)}catch{const t=document.createElement("textarea");t.value=_.value,t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),v.value=!0,setTimeout(()=>{v.value=!1},1500)}},m=d([]),K=d(1),$=d(!0),y=d(!1),f=d(!1),p=d(!1),b=async(t=1,n=!1)=>{y.value=!0;try{const o=await U({page:t,pageSize:20});if(o.code===200&&o.data){const c=o.data||[];n?m.value=c:m.value=[...m.value,...c],$.value=c.length>=20,K.value=t}}catch(o){console.error("加载推广记录失败",o)}finally{y.value=!1}},M=async(t,n)=>{if(!(n?f:p).value){n?f.value=!0:p.value=!0;try{const c=await W({type:t});c.code===200?(k.success(c.message||"领取成功"),await b(1,!0)):k.error(c.message||"领取失败")}catch{k.error("领取失败")}finally{n?f.value=!1:p.value=!1}}};return I(()=>C.query.tab,t=>{t==="intro"||!t?T():t==="promotion"?z():t==="record"&&b(1,!0)}),E(()=>{C.query.tab||q.replace({query:{tab:"intro"}}),u.value==="intro"?T():u.value==="promotion"?z():u.value==="record"&&b(1,!0)}),(t,n)=>(i(),l("div",Z,[G(Y,{title:a(s)("recommend.header-title")},null,8,["title"]),e("div",ee,[(i(),l(h,null,x(N,o=>e("button",{key:o.key,onClick:c=>S(o.key),class:w(["py-3 text-center transition-colors",u.value===o.key?"text-red-500 font-bold border-b-2 border-red-500":"text-gray-500 hover:text-gray-700"])},r(a(s)(o.i18Key)),11,te)),64))]),e("div",oe,[u.value==="intro"?(i(),l("div",re,[L.value?(i(),l(h,{key:0},x(3,o=>e("div",{key:o,class:"h-4 bg-gray-200 rounded animate-pulse mb-2"})),64)):(i(),l("div",{key:1,class:"prose prose-sm max-w-none text-gray-700 mb-4",innerHTML:B.value},null,8,se)),e("div",ae,[e("div",ne,[e("div",null,r(a(s)("recommend.intro-table-header-1")),1),e("div",null,r(a(s)("recommend.intro-table-header-2")),1),e("div",null,r(a(s)("recommend.intro-table-header-3")),1),e("div",null,r(a(s)("recommend.intro-table-header-4")),1)]),(i(),l(h,null,x(V,o=>e("div",{key:o.level,class:"grid grid-cols-4 items-center border-t px-3 py-2 text-center text-sm"},[e("div",le,[e("img",{src:`/mine/level/${o.level}.png`,alt:`level-${o.level}`,class:"inline-block w-[18px] h-[18px]"},null,8,ie)]),e("div",null,r(o.eco.toLocaleString()),1),e("div",ce,[J(r(o.reward.toLocaleString())+" ",1),n[3]||(n[3]=e("img",{src:D,alt:"coin",class:"inline-block w-[13px] h-[13px]"},null,-1))]),e("div",null,r(o.rate),1)])),64))])])):u.value==="promotion"?(i(),l("div",de,[e("h2",ue,r(a(s)("recommend.promotion-title")),1),e("p",me,r(a(s)("recommend.promotion-desc")),1),e("textarea",{rows:"5",readonly:"",value:g.value?a(s)("common.loading"):_.value,class:"w-full resize-none rounded-md border border-gray-300 bg-white p-3 text-sm text-gray-700 leading-relaxed focus:outline-none"},null,8,ve),e("button",{type:"button",onClick:j,disabled:g.value,class:w(["mt-4 h-12 w-full rounded-md text-base font-medium text-white transition active:scale-95",g.value?"bg-[#cccccc]":v.value?"bg-green-500":"bg-[#ff5a1f]"])},r(v.value?a(s)("recommend.promotion-btn-1"):a(s)("recommend.promotion-btn-2")),11,fe)])):u.value==="record"?(i(),l("div",pe,[e("div",ge,[e("button",{onClick:n[0]||(n[0]=o=>M(9,!0)),disabled:f.value,class:w(["h-9 w-full rounded-full bg-gradient-to-r from-[#ff6a3a] to-[#ff1020] text-white font-medium transition active:scale-95",f.value?"opacity-60 cursor-not-allowed":"cursor-pointer"])},r(f.value?a(s)("common.form.button.submitting"):a(s)("recommend.record-receive-btn-1")),11,ye),e("button",{onClick:n[1]||(n[1]=o=>M(34,!1)),disabled:p.value,class:w(["h-9 w-full rounded-full bg-gradient-to-r from-[#ff6a3a] to-[#ff1020] text-white font-medium transition active:scale-95",p.value?"opacity-60 cursor-not-allowed":"cursor-pointer"])},r(p.value?a(s)("common.form.button.submitting"):a(s)("recommend.record-receive-btn-2")),11,_e)]),e("div",be,[e("div",he,r(a(s)("recommend.record-table-header-1")),1),e("div",xe,r(a(s)("recommend.record-table-header-2")),1),e("div",we,r(a(s)("recommend.record-table-header-3")),1),e("div",ke,r(a(s)("recommend.record-table-header-4")),1)]),y.value&&m.value.length===0?(i(),l("div",Ce,[n[4]||(n[4]=e("div",{class:"inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"},null,-1)),e("span",Le,r(a(s)("common.loading")),1)])):m.value.length===0?(i(),l("div",$e," 暂无数据 ")):(i(),l("div",Re,[(i(!0),l(h,null,x(m.value,(o,c)=>(i(),l("div",{key:c,class:"grid grid-cols-[0.5fr_1fr_1fr_1fr] px-3 py-3 border-b text-sm items-center"},[e("div",qe,r(o?.nickname||""),1),e("div",Be,r(o?.experience||0),1),e("div",Te,r(o?.tzpoints||0),1),e("div",ze,r(o?.tgall||0),1)]))),128)),$.value?(i(),l("div",Ke,[e("button",{onClick:n[2]||(n[2]=o=>b(K.value+1,!1)),disabled:y.value,class:"px-6 py-2 bg-red-600 text-white text-sm rounded-lg disabled:opacity-50"},r(y.value?a(s)("common.loading"):"加载更多"),9,Me)])):R("",!0),!$.value&&m.value.length>0?(i(),l("div",Ne,r(a(s)("common.loading-list-empty")),1)):R("",!0)]))])):R("",!0)])]))}});export{Ge as default};
