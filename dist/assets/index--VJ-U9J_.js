import{d as w,o as k,r as a,b as M,q as o,n as t,C as p,f as C,y as g,F as D,t as B,x as f,D as R,l as n}from"./vue-vendor-2ZNhN7Rr.js";import{M as Y}from"./customer-CDJyDjhM.js";import{t as y}from"./index-CIZoSaJ3.js";import{d as j}from"./dayjs.min-CLb2-34J.js";import{C as V}from"./chevron-left-DCF22wfj.js";import"./utils-vendor-CbLx3nH2.js";const z={class:"flex min-h-screen justify-center bg-[#eef3f8]"},F={class:"w-full max-w-xl bg-[#f5f7fb] shadow-sm"},I={class:"sticky top-0 z-40 bg-gradient-to-r from-red-600 to-red-500"},L={class:"flex h-12 items-center justify-between px-3"},N={class:"text-center"},P={class:"text-center"},q={class:"text-center font-medium text-red-500"},E={key:1,class:"py-4 text-center text-xs text-gray-400"},H=w({__name:"index",setup(O){const _=R(),l=a([]),x=a(1),i=a(!0),c=a(!1),u=a(null);let d=null;const m=async r=>{c.value=!0;try{const{code:e,data:s,message:v}=await Y({pagination:{page:r,size:20}});await new Promise(h=>setTimeout(h,500)),e===200?(s.length<20&&(i.value=!1),r===1&&(l.value=[]),l.value=[...l.value,...s]):y.error(v)}catch{y.error("获取数据失败")}finally{c.value=!1}};k(async()=>{await m(1),u.value&&i.value&&(d=new IntersectionObserver(([r])=>{if(r.isIntersecting&&!c.value){const e=x.value+1;x.value=e,m(e)}},{threshold:1}),d.observe(u.value))}),M(()=>{d&&d.disconnect()});const b=()=>{_.back()};return(r,e)=>(n(),o("div",z,[t("div",F,[t("header",I,[t("div",L,[t("button",{onClick:b,class:"flex items-center text-white"},[C(g(V),{class:"h-5 w-5"})]),e[0]||(e[0]=t("span",{class:"text-white font-bold"},"道具记录",-1)),e[1]||(e[1]=t("div",{class:"w-5"},null,-1))])]),e[2]||(e[2]=t("div",{class:"grid grid-cols-[1fr_1fr_1fr] px-3 py-2 text-xs text-gray-500 border-b bg-white"},[t("div",{class:"text-center"},"日期"),t("div",{class:"text-center"},"道具"),t("div",{class:"text-center"},"数量")],-1)),(n(!0),o(D,null,B(l.value,(s,v)=>(n(),o("div",{key:`all-key-${v}`,class:"grid grid-cols-[1fr_1fr_1fr] px-3 py-3 border-b text-sm items-center bg-white"},[t("div",N,f(g(j).unix(s?.addtime||0).format("YYYY-MM-DD")),1),t("div",P,f(s?.name||"--"),1),t("div",q,f(s?.num||0),1)]))),128)),i.value?(n(),o("div",{key:0,ref_key:"loadMoreRef",ref:u,class:"py-4 text-center text-xs text-gray-400"},f(c.value?"加载中...":"上拉加载更多"),513)):p("",!0),i.value?p("",!0):(n(),o("div",E," 没有更多数据了 ")),e[3]||(e[3]=t("div",{class:"h-14"},null,-1))])]))}});export{H as default};
