import{d as V,w as D,o as P,q as i,l as e,k as F,f as b,u as s,z as a,r as m,J as k,F as E,t as R,K as S,p as G,B as H,I as J,v as r}from"./vue-vendor-ntQnFNWs.js";import{c as I,a as K,t as w}from"./index-FdFg60UN.js";import{m as A,s as O}from"./game-D5Zp6FTN.js";import"./utils-vendor-CbLx3nH2.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=I("PenIcon",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=I("PlusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=I("Trash2Icon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),X={class:"bg-gray-100 pb-16"},Y={class:"bg-white mx-3 my-3 rounded-lg shadow"},Z={class:"bg-white mx-3 my-3 rounded-lg shadow"},ee={class:"grid grid-cols-[1fr_80px_80px] text-xs text-gray-500 border-b bg-gray-50 px-3 py-2 gap-2 rounded-t-lg"},te={class:"text-center"},se={class:"text-center"},oe={key:0,class:"flex justify-center items-center py-8"},ae={class:"ml-2 text-gray-600"},le={key:1,class:"text-center py-8 text-gray-500"},ne={key:2,class:"divide-y"},de={class:"grid grid-cols-[1fr_80px_80px] items-center gap-2"},re={class:"font-medium text-gray-800 truncate"},ie={class:"text-center text-red-600 font-medium"},ce={class:"flex justify-center gap-1"},ue=["onClick","title"],me=["onClick","title"],ge={class:"mt-2 text-xs text-gray-500"},_e={class:"flex items-start gap-1"},pe={class:"text-gray-400 flex-shrink-0"},ye={class:"line-clamp-2 break-all"},ve={class:"flex items-start gap-1 mt-1"},he={class:"text-gray-400 flex-shrink-0"},fe={class:"line-clamp-1 break-all"},xe={key:0,class:"py-4 text-center"},be=["disabled"],ke={key:1,class:"py-4 text-center text-gray-400 text-sm"},we={class:"mx-4 w-full max-w-sm rounded-lg bg-white p-4"},Ie={class:"text-lg font-medium mb-2"},Ce={class:"text-gray-600 mb-4"},Me={class:"flex gap-3"},$=20,qe=V({__name:"mode",setup(Ne){const{t}=K(),p=J(),C=H(),d=m([]),c=m(!1),M=m(1),y=m(!0),g=m(!1),u=m(null),v=()=>Number(p.query.lottery_id)||0,N=()=>Number(p.query.group_id)||0,z=l=>{const o=typeof l=="string"?parseInt(l,10):l;return isNaN(o)?"0":new Intl.NumberFormat("zh-CN").format(o)},h=async(l=1,o=!1)=>{const n=v(),f=N();if(n)try{c.value=!0;const _=await A({lottery_id:n,game_group_id:f,page:l,pageSize:$});if(_.code===200&&_.data){const x=_.data.list||[];o?d.value=x:d.value=[...d.value,...x],y.value=x.length>=$,M.value=l}else o&&(d.value=[])}catch(_){console.error("获取模式列表失败:",_),o&&(d.value=[])}finally{c.value=!1}},L=()=>{c.value||!y.value||h(M.value+1,!1)},j=async()=>{if(u.value)try{const l=await O({id:u.value.id,status:0});l.code===200?(w.success(t("games.mode.delete-success")),d.value=d.value.filter(o=>o.id!==u.value?.id)):w.error(l.message||t("games.mode.delete-failed"))}catch{w.error(t("games.mode.delete-failed-retry"))}finally{g.value=!1,u.value=null}},q=l=>{u.value=l,g.value=!0},B=()=>{const l=v(),o=N();C.push(`/games/mode/edit?lottery_id=${l}&group_id=${o}`)},T=l=>{const o=v();C.push(`/games/mode/edit?lottery_id=${o}&group_id=${l.game_group_id}&mode_id=${l.id}`)};return D(()=>[p.query.lottery_id,p.query.group_id],()=>{h(1,!0)}),P(()=>{h(1,!0)}),(l,o)=>(r(),i("div",X,[e("div",Y,[e("button",{onClick:B,class:"w-full flex items-center justify-center gap-2 py-4 text-red-600 hover:bg-red-50"},[b(s(U),{size:20}),e("span",null,a(s(t)("games.mode.create")),1)])]),e("div",Z,[e("div",ee,[e("span",null,a(s(t)("games.mode.name")),1),e("span",te,a(s(t)("games.mode.total-coins")),1),e("span",se,a(s(t)("games.mode.operations")),1)]),c.value&&d.value.length===0?(r(),i("div",oe,[o[2]||(o[2]=e("div",{class:"inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"},null,-1)),e("span",ae,a(s(t)("games.mode.loading")),1)])):d.value.length===0?(r(),i("div",le,a(s(t)("games.mode.no-data")),1)):(r(),i("div",ne,[(r(!0),i(E,null,R(d.value,n=>(r(),i("div",{key:n.id,class:"px-3 py-3 text-sm bg-white hover:bg-gray-50"},[e("div",de,[e("div",re,a(n.mode_name),1),e("div",ie,a(z(n.bet_gold)),1),e("div",ce,[e("button",{onClick:f=>T(n),class:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:s(t)("games.mode.edit")},[b(s(Q),{size:16})],8,ue),e("button",{onClick:f=>q(n),class:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:s(t)("games.mode.delete")},[b(s(W),{size:16})],8,me)])]),e("div",ge,[e("div",_e,[e("span",pe,a(s(t)("games.mode.play-method")),1),e("span",ye,a(n.bet_no),1)]),e("div",ve,[e("span",he,a(s(t)("games.mode.coins")),1),e("span",fe,a(n.bet_no_gold),1)])])]))),128)),y.value?(r(),i("div",xe,[e("button",{onClick:L,disabled:c.value,class:"px-6 py-2 bg-red-600 text-white text-sm rounded-lg disabled:opacity-50"},a(c.value?s(t)("common.loading"):s(t)("games.mode.load-more")),9,be)])):k("",!0),!y.value&&d.value.length>0?(r(),i("div",ke,a(s(t)("games.mode.no-more")),1)):k("",!0)]))]),(r(),F(G,{to:"body"},[g.value?(r(),i("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:o[1]||(o[1]=S(n=>g.value=!1,["self"]))},[e("div",we,[e("div",Ie,a(s(t)("games.mode.delete-confirm")),1),e("div",Ce,a(s(t)("games.mode.delete-confirm-msg"))+' "'+a(u.value?.mode_name)+'"? ',1),e("div",Me,[e("button",{onClick:o[0]||(o[0]=n=>g.value=!1),class:"flex-1 py-2 bg-gray-200 text-gray-700 rounded-lg"},a(s(t)("common.cancel")),1),e("button",{onClick:j,class:"flex-1 py-2 bg-red-600 text-white rounded-lg"},a(s(t)("games.mode.delete-confirm")),1)])])])):k("",!0)]))]))}});export{qe as default};
