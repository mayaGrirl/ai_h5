import{d as Ue,w as ie,o as De,r as _,b as Je,q as m,J as F,l as o,k as ue,F as h,t as E,c as G,z as c,u as y,L as U,f as He,Q as Xe,R as Ye,x as S,K as Ze,p as et,I as tt,v as d}from"./vue-vendor-ntQnFNWs.js";import{_ as xe}from"./coin-BjeO1Yvx.js";import{a as at,u as lt,t as C}from"./index-jbolejyT.js";import{u as st}from"./game-ChQhtl2e.js";import{b as nt,m as ot,a as _e,p as rt,f as it}from"./game-DedpHW39.js";import{C as ut}from"./chevron-up-DNKpmeqN.js";import{C as he}from"./chevron-down-Dd4920X5.js";import"./utils-vendor-CbLx3nH2.js";const ct={class:"bg-gray-100 min-h-screen pb-32"},dt={key:0,class:"bg-white mx-3 mt-3 rounded-lg shadow p-3"},mt={class:"grid grid-cols-6 gap-2 mb-2"},pt=["onClick"],vt={class:"grid grid-cols-6 gap-2 mb-2"},gt=["onClick"],ft={class:"grid grid-cols-6 gap-2"},bt=["onClick"],yt=["onClick"],xt={key:1,class:"grid grid-cols-4 gap-2"},_t=["onClick"],ht={key:0,class:"mt-4 grid grid-cols-2 gap-3"},kt={class:"flex items-center mb-2"},wt={class:"text-xs text-gray-600 mx-1"},Ct={class:"grid grid-cols-4 gap-1"},Et=["onClick"],St={class:"grid grid-cols-4 gap-1 mt-1"},At=["onClick"],It={class:"grid grid-cols-4 gap-1 mt-1"},Nt=["onClick"],Gt={class:"flex items-center mb-2"},jt={class:"text-xs text-gray-600 mx-1"},Mt={class:"grid grid-cols-3 gap-1"},Bt=["onClick"],$t={class:"grid grid-cols-4 gap-1 mt-1"},Tt=["onClick"],Pt={class:"grid grid-cols-5 gap-1 mt-1"},Rt=["onClick"],Ot={class:"mt-4"},Vt={class:"flex items-center mb-2"},Lt={class:"text-xs text-gray-600 mx-2"},qt={class:"grid grid-cols-6 gap-2"},zt=["onClick"],Ft={class:"grid grid-cols-6 gap-2 mt-2"},Wt=["onClick"],Kt={class:"grid grid-cols-2 gap-3 mt-3"},Qt={class:"flex items-center gap-1.5 mt-3"},Ut={class:"flex gap-0.5 flex-shrink-0"},Dt=["onClick"],Jt=["src","alt"],Ht=["placeholder"],Xt={class:"bg-white mx-3 mt-3 mb-[50px] rounded-lg shadow"},Yt={class:"grid grid-cols-[80px_1fr_100px_90px] text-xs text-gray-500 border-b px-3 py-2"},Zt={class:"text-center"},ea={class:"text-center"},ta={key:0,class:"flex justify-center items-center py-8"},aa={class:"ml-2 text-gray-600"},la={key:1,class:"divide-y"},sa={class:"flex flex-col items-start"},na=["onClick"],oa={class:"text-xs text-gray-500 mt-1"},ra=["value","onInput","onFocus"],ia={class:"flex gap-1 justify-end"},ua=["onClick"],ca=["onClick"],da=["onClick"],ma={key:2,class:"text-center py-8 text-gray-500"},pa={class:"fixed bottom-14 left-0 right-0 bg-white border-t shadow-lg"},va={key:0,class:"flex items-center justify-between px-4 py-1.5 bg-gray-50 border-b text-xs"},ga={class:"flex items-center gap-2"},fa={class:"text-gray-500"},ba={class:"text-blue-700 font-medium"},ya={class:"flex items-center gap-2"},xa={class:"text-red-600 font-bold"},_a={class:"text-gray-400 text-[10px]"},ha={class:"flex justify-between px-4 py-2 border-b"},ka={class:"flex items-center text-sm"},wa={class:"text-gray-600"},Ca={class:"text-red-600 font-bold ml-1"},Ea={class:"flex items-center text-sm"},Sa={class:"text-gray-600"},Aa={class:"text-red-600 font-bold ml-1"},Ia={class:"grid grid-cols-3 h-12"},Na={class:"bg-white text-gray-700 font-bold flex flex-col items-center justify-center border-x"},Ga={class:"text-xs text-gray-500"},ja={class:"text-red-600 font-bold"},Ma={class:"text-xs text-gray-500"},Ba={class:"text-orange-600 font-bold"},$a=["disabled"],Ta={class:"mx-4 w-full max-w-sm rounded-lg bg-white flex flex-col max-h-[70vh]"},Pa={class:"p-3 border-b font-medium"},Ra={class:"flex-1 overflow-y-auto"},Oa={key:0,class:"flex justify-center items-center py-8"},Va={class:"ml-2 text-gray-600"},La={key:1,class:"text-center py-8 text-gray-500"},qa={class:"text-sm mt-2"},za={key:2,class:"divide-y"},Fa=["onClick"],Wa={class:"font-medium text-gray-800"},Ka={class:"font-bold text-red-600"},Qa={class:"p-3 border-t"},al=Ue({__name:"play",setup(Ua){const{t:r}=at(),ke=tt(),k=st(),D=lt(),W=_([]),J=_(!0),f=_(null),g=_([]),x=_({}),w=_(null),R=_(!1),H=_(null),O=_(""),M=_(!1),B=_([]),X=_(!1),Y=_(null),V=_(null),j=_(null),$=_(0),T=_(0),Z=_(200),ce=_(""),I=_({});let ee=null,te=null,P=!1,K=!1,L=0,Q="",A=null,ae=k.soundEnabled,le=!0;const de=[1,3,10,14,18,22,4,26,5,16,23,6,15,24],we=G(()=>[{value:"全包",label:r("games.play.all")},{value:"单",label:r("games.play.odd")},{value:"大单",label:r("games.play.big-odd")},{value:"小单",label:r("games.play.small-odd")},{value:"单边",label:r("games.play.odd-side")},{value:"双",label:r("games.play.even")}]),Ce=G(()=>[{value:"大双",label:r("games.play.big-even")},{value:"小双",label:r("games.play.small-even")},{value:"双边",label:r("games.play.even-side")},{value:"大",label:r("games.play.big")},{value:"小",label:r("games.play.small")},{value:"中",label:r("games.play.middle")}]),Ee=G(()=>[{value:"边",label:r("games.play.side")},{value:"大边",label:r("games.play.big-side")},{value:"小边",label:r("games.play.small-side")}]),Se=G(()=>[{value:"上期",label:r("games.play.last-period")},{value:"反选",label:r("games.play.reverse")},{value:"清空",label:r("games.play.clear")}]),Ae=G(()=>[{value:"全包",label:r("games.play.all")},{value:"上期",label:r("games.play.last-period")},{value:"反选",label:r("games.play.reverse")},{value:"清空",label:r("games.play.clear")}]),se=G(()=>[{value:"0尾",label:r("games.play.tail-0")},{value:"1尾",label:r("games.play.tail-1")},{value:"2尾",label:r("games.play.tail-2")},{value:"3尾",label:r("games.play.tail-3")},{value:"4尾",label:r("games.play.tail-4")},{value:"5尾",label:r("games.play.tail-5")},{value:"6尾",label:r("games.play.tail-6")},{value:"7尾",label:r("games.play.tail-7")},{value:"8尾",label:r("games.play.tail-8")},{value:"9尾",label:r("games.play.tail-9")},{value:"小尾",label:r("games.play.tail-small")},{value:"大尾",label:r("games.play.tail-big")}]),Ie=G(()=>[{value:"3余0",label:r("games.play.mod3-0")},{value:"3余1",label:r("games.play.mod3-1")},{value:"3余2",label:r("games.play.mod3-2")}]),Ne=G(()=>[{value:"4余0",label:r("games.play.mod4-0")},{value:"4余1",label:r("games.play.mod4-1")},{value:"4余2",label:r("games.play.mod4-2")},{value:"4余3",label:r("games.play.mod4-3")}]),Ge=G(()=>[{value:"5余0",label:r("games.play.mod5-0")},{value:"5余1",label:r("games.play.mod5-1")},{value:"5余2",label:r("games.play.mod5-2")},{value:"5余3",label:r("games.play.mod5-3")},{value:"5余4",label:r("games.play.mod5-4")}]),je=[.1,.5,.8,1.2,1.5,2],Me=[5,10,20,30,50,100],Be=[{display:"10",value:1e4,img:"/chips/10.png"},{display:"100",value:1e5,img:"/chips/100.png"},{display:"500",value:5e5,img:"/chips/500.png"},{display:"1K",value:1e6,img:"/chips/1000.png"},{display:"5K",value:5e6,img:"/chips/5000.png"}],ne=G(()=>g.value.reduce((s,a)=>s+(parseInt(x.value[a]||"0",10)||0),0)),$e=()=>{try{const s=window.AudioContext||window.webkitAudioContext;if(!s)return;const a=new s,e=a.createOscillator(),i=a.createGain();e.connect(i),i.connect(a.destination),e.frequency.value=880,e.type="sine",i.gain.setValueAtTime(.3,a.currentTime),i.gain.exponentialRampToValueAtTime(.01,a.currentTime+.3),e.start(a.currentTime),e.stop(a.currentTime+.3);const v=a.createOscillator(),l=a.createGain();v.connect(l),l.connect(a.destination),v.frequency.value=1320,v.type="sine",l.gain.setValueAtTime(0,a.currentTime+.15),l.gain.linearRampToValueAtTime(.3,a.currentTime+.16),l.gain.exponentialRampToValueAtTime(.01,a.currentTime+.5),v.start(a.currentTime+.15),v.stop(a.currentTime+.5)}catch(s){console.error("播放提示音失败",s)}},me=s=>s?s.split(",").map(a=>parseInt(a.trim(),10)||1):[],pe=(s,a,e,i)=>{if(a.length===0)return 1;const v=parseInt(s,10);if(!isNaN(v)){const u=v-e;if(u>=0&&u<a.length)return a[u]}const l=i.findIndex(u=>u.name===s);return l>=0&&l<a.length?a[l]:1},ve=async()=>{try{await D.fetchCurrentCustomer()}catch(s){console.error("刷新用户金豆失败",s)}},ge=async s=>{if(!(!k.activeGame?.id||!A||!s))try{const a=await _e({lottery_id:k.activeGame.id,game_group_id:A,expect_no:s,page:1,pageSize:100});if(a.code===200&&a.data){const e={};(a.data.list||[]).forEach(v=>{const l=v.bet_no;l&&typeof l=="object"&&(Array.isArray(l)?l:Object.values(l)).forEach(p=>{const b=p.bet_no,t=p.bet_gold||0;b&&(e[b]=(e[b]||0)+t)})}),I.value=e}else I.value={}}catch(a){console.error("获取已投注记录失败",a),I.value={}}},Te=async()=>{if(!k.activeGame?.id||!A||!j.value?.expect_no){C.error(r("games.play.load-last-failed"));return}try{const s=await _e({lottery_id:k.activeGame.id,game_group_id:A,expect_no:j.value.expect_no,page:1,pageSize:100});if(s.code===200&&s.data){const a=s.data.list||[];if(a.length===0){C.info(r("games.play.no-last-bets"));return}const e={};a.forEach(l=>{const u=l.bet_no;u&&typeof u=="object"&&(Array.isArray(u)?u:Object.values(u)).forEach(b=>{const t=b.bet_no,n=b.bet_gold||0;t&&(e[t]=(e[t]||0)+n)})});const i=Object.keys(e);if(i.length===0){C.info(r("games.play.no-last-bets"));return}g.value=i;const v={};i.forEach(l=>{v[l]=String(e[l])}),x.value=v,C.success(r("games.play.loaded-last-bets",{count:i.length}))}else C.info(r("games.play.no-last-bets"))}catch(s){console.error("获取上期投注记录失败",s),C.error(r("games.play.load-last-failed"))}},Pe=()=>{if(!j.value?.finalRes)return"--";const s=j.value.finalRes;if(A){const e=`finalOpenRes${A}`,i=s[e];if(i!=null)return String(i)}const a=s.nums;return a?Array.isArray(a)?a.join(","):typeof a=="object"?Object.values(a).join(","):String(a):"--"},Re=async()=>{if(k.activeGame?.id)try{J.value=!0;const s=await rt({lottery_id:k.activeGame.id});if(s.code===200&&s.data){const{gamePlayMap:a=[],groupArr:e=[]}=s.data,i={};e.forEach(p=>{i[p.id]={betMultiplier:p.bet_multiplier||"",startNum:p.start_num||0}});const v=a.map(p=>{const b=i[p.id]||{betMultiplier:"",startNum:0};return{id:p.id,name:p.name,lang_name:p.lang_name,betMultiplier:b.betMultiplier,startNum:b.startNum,plays:(p.children||[]).map(t=>({id:t.id,name:t.name,lang_name:t.lang_name,odds:t.multiple||0,minBetGold:t.min_bet_gold||0}))}}).filter(p=>p.plays.length>0);W.value=v;let l=null;const u=ke.query.group_id;if(u&&v.length>0){const p=v.find(b=>String(b.id)===u);p?(f.value=p,l=Number(p.id)):(f.value=v[0],l=Number(v[0].id))}else v.length>0&&(f.value=v[0],l=Number(v[0].id));A=l,l&&(oe(l),le=!1)}else s.code!==3001&&C.error(s.message||r("games.play.load-plays-failed"))}catch(s){console.error("获取玩法列表失败",s),C.error(r("games.play.load-plays-failed-retry"))}finally{J.value=!1}},oe=async s=>{const a=s??A;if(!(!k.activeGame?.id||!a))try{const e=await it({lottery_id:k.activeGame.id,game_group_id:a});if(Z.value=e.code,e.code===200&&e.data){const i=e.data.currExpectInfo?.expect_no;i&&i!==Q&&(Q&&(ve(),ae&&$e()),Q=i,ce.value=i,ge(i)),V.value=e.data.currExpectInfo||null,j.value=e.data.lastExpectInfo||null;const v=e.data.currExpectInfo?.open_countdown||0;L=v,$.value=v,T.value=e.data.currExpectInfo?.close_countdown||0,P=!1}else if(e.code===3001&&e.data){const i=e.data.currExpectInfo,v=e.data.lastExpectInfo;if(i){V.value=i;const l=i.open_countdown||0;L=l,$.value=l,T.value=i.close_countdown||0}v&&(j.value=v),P=!1}else P=!0,C.error(e.message||r("games.play.load-expect-failed"))}catch(e){console.error("获取开奖信息失败",e),P=!0,C.error(r("games.play.load-expect-failed-retry"))}},fe=s=>{const a=Math.floor(s/60),e=s%60;return`${String(a).padStart(2,"0")}:${String(e).padStart(2,"0")}`};ie(()=>k.selectedGroupId,s=>{if(s==null||W.value.length===0)return;const a=W.value.find(e=>Number(e.id)===s);a&&(!f.value||Number(f.value.id)!==s)&&(g.value=[],x.value={},f.value=a,w.value=null,M.value=!1,B.value=[],Y.value=null,I.value={},A=s,le||(oe(s),V.value?.expect_no&&setTimeout(()=>{ge(V.value.expect_no)},100)))}),ie(()=>k.soundEnabled,s=>{ae=s}),ie(()=>k.activeGame?.id,s=>{s&&(P=!1,K=!1,L=0,Q="",A=null,le=!0,ce.value="",W.value=[],f.value=null,g.value=[],x.value={},I.value={},Re())},{immediate:!0});const be=s=>{const a=s.name;if(g.value.includes(a)){g.value=g.value.filter(i=>i!==a);const e={...x.value};delete e[a],x.value=e}else{const e=s.minBetGold||0;e>0&&(x.value={...x.value,[a]:String(e)}),g.value=[...g.value,a]}},Oe=(s,a)=>{x.value={...x.value,[s]:a}},N=s=>{if(!f.value)return;const a=Number(f.value.id),e=f.value.plays.filter(t=>!isNaN(parseInt(t.name,10))).sort((t,n)=>parseInt(t.name,10)-parseInt(n.name,10));if(["全包","单","双","大单","小单","大双","小双","单边","双边","大","小","中","边","大边","小边","0尾","1尾","2尾","3尾","4尾","5尾","6尾","7尾","8尾","9尾","小尾","大尾","3余0","3余1","3余2","4余0","4余1","4余2","4余3","5余0","5余1","5余2","5余3","5余4"].includes(s)&&w.value===s){g.value=[],x.value={},w.value=null;return}const l=(t=>[1,2,3,10,14,18,22].includes(t)?{min:0,max:27,bigStart:14,smallEnd:13,midStart:10,midEnd:17,bigEdgeStart:18,smallEdgeEnd:9}:[6,15,24].includes(t)?{min:3,max:18,bigStart:11,smallEnd:10,midStart:8,midEnd:13,bigEdgeStart:14,smallEdgeEnd:7}:[5,16,23].includes(t)?{min:2,max:12,bigStart:7,smallEnd:6,midStart:5,midEnd:9,bigEdgeStart:10,smallEdgeEnd:4}:[4,26].includes(t)?{min:1,max:10,bigStart:6,smallEnd:5,midStart:4,midEnd:7,bigEdgeStart:8,smallEdgeEnd:3}:null)(a);let u=[],p=s;switch(s){case"清空":g.value=[],x.value={},w.value=null;return;case"反选":u=f.value.plays.filter(t=>!g.value.includes(t.name)).map(t=>t.name),p=null;break;case"上期":Te(),w.value=null;return;case"全包":u=f.value.plays.map(t=>t.name);break;case"单":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.min&&n<=l.max&&n%2===1}).map(t=>t.name));break;case"双":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.min&&n<=l.max&&n%2===0}).map(t=>t.name));break;case"大单":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.bigStart&&n<=l.max&&n%2===1}).map(t=>t.name));break;case"小单":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.min&&n<=l.smallEnd&&n%2===1}).map(t=>t.name));break;case"大双":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.bigStart&&n<=l.max&&n%2===0}).map(t=>t.name));break;case"小双":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.min&&n<=l.smallEnd&&n%2===0}).map(t=>t.name));break;case"单边":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.min&&n<=l.max&&(n<l.midStart||n>l.midEnd)&&n%2===1}).map(t=>t.name));break;case"双边":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.min&&n<=l.max&&(n<l.midStart||n>l.midEnd)&&n%2===0}).map(t=>t.name));break;case"大":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.bigStart&&n<=l.max}).map(t=>t.name));break;case"小":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.min&&n<=l.smallEnd}).map(t=>t.name));break;case"中":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.midStart&&n<=l.midEnd}).map(t=>t.name));break;case"边":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.min&&n<=l.max&&(n<l.midStart||n>l.midEnd)}).map(t=>t.name));break;case"大边":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.bigEdgeStart&&n<=l.max}).map(t=>t.name));break;case"小边":l&&(u=e.filter(t=>{const n=parseInt(t.name,10);return n>=l.min&&n<=l.smallEdgeEnd}).map(t=>t.name));break;case"0尾":case"1尾":case"2尾":case"3尾":case"4尾":case"5尾":case"6尾":case"7尾":case"8尾":case"9尾":{const t=parseInt(s.replace("尾",""),10);u=e.filter(n=>parseInt(n.name,10)%10===t).map(n=>n.name);break}case"小尾":u=e.filter(t=>parseInt(t.name,10)%10<=4).map(t=>t.name);break;case"大尾":u=e.filter(t=>parseInt(t.name,10)%10>=5).map(t=>t.name);break;case"3余0":case"3余1":case"3余2":{const t=parseInt(s.replace("3余",""),10);u=e.filter(n=>parseInt(n.name,10)%3===t).map(n=>n.name);break}case"4余0":case"4余1":case"4余2":case"4余3":{const t=parseInt(s.replace("4余",""),10);u=e.filter(n=>parseInt(n.name,10)%4===t).map(n=>n.name);break}case"5余0":case"5余1":case"5余2":case"5余3":case"5余4":{const t=parseInt(s.replace("5余",""),10);u=e.filter(n=>parseInt(n.name,10)%5===t).map(n=>n.name);break}}const b={};u.forEach(t=>{const n=f.value.plays.find(q=>q.name===t);n&&n.minBetGold>0&&(b[t]=String(n.minBetGold))}),x.value=b,g.value=u,w.value=p},ye=s=>{if(H.value=s,g.value.length>0){const a={...x.value};g.value.forEach(e=>{const i=parseInt(a[e]||"0",10);i>0&&(a[e]=String(Math.floor(i*s)))}),x.value=a}},Ve=s=>{O.value=String(s)},Le=()=>{if(!O.value||g.value.length===0||!f.value)return;const s=parseInt(O.value,10);if(isNaN(s)||s<=0)return;const a=me(f.value.betMultiplier),e=f.value.startNum||0,i=f.value.plays||[];let v=0;const l={};g.value.forEach(t=>{const n=pe(t,a,e,i);l[t]=n,v+=n});const u={};let p=0;g.value.forEach(t=>{const n=l[t],q=parseInt(x.value[t]||"0",10)||0,z=Math.floor(n/v*s);p+=z,u[t]=String(z+q)});const b=s-p;if(b>0&&g.value.length>0){const t=g.value[g.value.length-1],n=parseInt(u[t],10);u[t]=String(n+b)}x.value=u},qe=async()=>{if(!(!k.activeGame?.id||!A))try{X.value=!0;const s=await ot({lottery_id:k.activeGame.id,game_group_id:A,page:1,pageSize:100});s.code===200&&s.data?B.value=s.data.list||[]:B.value=[]}catch(s){console.error("获取模式列表失败",s),B.value=[]}finally{X.value=!1}},ze=()=>{M.value=!0,qe()},Fe=s=>{if(!f.value)return;const a=s.bet_no.split(",").map(l=>l.trim()).filter(l=>l),e=s.bet_no_gold.split(",").map(l=>l.trim()).filter(l=>l),i=[],v={};a.forEach((l,u)=>{f.value.plays.some(b=>b.name===l)&&(i.push(l),e[u]&&(v[l]=e[u]))}),g.value=i,x.value=v,Y.value=s,M.value=!1,C.success(r("games.play.mode-applied",{name:s.mode_name}))},We=()=>{if(g.value.length===0||!D.currentCustomer||!f.value)return;const s=D.currentCustomer.points||0;if(s<=0)return;const a=me(f.value.betMultiplier),e=f.value.startNum||0,i=f.value.plays||[];let v=0;const l={};g.value.forEach(t=>{const n=pe(t,a,e,i);l[t]=n,v+=n});const u={};let p=0;g.value.forEach(t=>{const n=l[t],q=parseInt(x.value[t]||"0",10)||0,z=Math.floor(n/v*s);p+=z,u[t]=String(z+q)});const b=s-p;if(b>0&&g.value.length>0){const t=g.value[g.value.length-1],n=parseInt(u[t],10);u[t]=String(n+b)}x.value=u},re=(s,a)=>{const e=parseInt(x.value[s]||"0",10),i=Math.max(0,Math.floor(e*a));x.value={...x.value,[s]:String(i)}},Ke=async()=>{if(!f.value){C.error(r("games.play.select-group"));return}const s=V.value?.expect_no||"",a=f.value.id,e=g.value.join(","),i=g.value.map(p=>x.value[p]||"0").join(","),v=g.value.map(p=>{const b=f.value.plays.find(t=>t.name===p);return b?b.id:""}).filter(p=>p!=="").join(","),l=g.value.reduce((p,b)=>p+(parseInt(x.value[b]||"0",10)||0),0);if(!s){C.error(r("games.play.expect-missing"));return}if(l<=0){C.error(r("games.play.enter-amount"));return}const u={game_group_id:a,lottery_id:k.activeGame.id,bet_no:e,bet_expect_no:s,bet_gold:i,lottery_played_id:v,total_gold:l};try{const p=await nt(u);if(p.code===200){C.success(r("games.play.bet-success"));const b={...I.value};g.value.forEach(t=>{const n=parseInt(x.value[t]||"0",10)||0;n>0&&(b[t]=(b[t]||0)+n)}),I.value=b,g.value=[],x.value={},w.value=null,ve()}else p.code!==3001&&C.error(p.message||r("games.play.bet-failed-retry"))}catch(p){console.error("投注失败：",p),C.error(r("games.play.bet-failed-retry"))}},Qe=()=>{g.value=[],x.value={},w.value=null};return De(()=>{k.initSoundSetting(),ae=k.soundEnabled,ee=setInterval(()=>{$.value>0&&($.value--,L=$.value),T.value>0&&T.value--},1e3),te=setInterval(()=>{L<=0&&!P&&!K&&(K=!0,oe().finally(()=>{K=!1}))},2e3)}),Je(()=>{ee&&clearInterval(ee),te&&clearInterval(te)}),(s,a)=>(d(),m("div",ct,[f.value?(d(),m("div",dt,[de.includes(Number(f.value.id))?(d(),m(h,{key:0},[o("div",mt,[(d(!0),m(h,null,E(we.value,e=>(d(),m("button",{key:e.value,onClick:i=>N(e.value),class:S(["py-1.5 text-xs rounded border",w.value===e.value?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300 hover:border-red-500"])},c(e.label),11,pt))),128))]),o("div",vt,[(d(!0),m(h,null,E(Ce.value,e=>(d(),m("button",{key:e.value,onClick:i=>N(e.value),class:S(["py-1.5 text-xs rounded border",w.value===e.value?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300 hover:border-red-500"])},c(e.label),11,gt))),128))]),o("div",ft,[(d(!0),m(h,null,E(Ee.value,e=>(d(),m("button",{key:e.value,onClick:i=>N(e.value),class:S(["py-1.5 text-xs rounded border",w.value===e.value?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300 hover:border-red-500"])},c(e.label),11,bt))),128)),(d(!0),m(h,null,E(Se.value,e=>(d(),m("button",{key:e.value,onClick:i=>N(e.value),class:"py-1.5 text-xs rounded bg-red-600 text-white"},c(e.label),9,yt))),128))])],64)):(d(),m("div",xt,[(d(!0),m(h,null,E(Ae.value,e=>(d(),m("button",{key:e.value,onClick:i=>N(e.value),class:"py-1.5 text-xs rounded bg-red-600 text-white"},c(e.label),9,_t))),128))])),R.value?(d(),m(h,{key:2},[de.includes(Number(f.value.id))?(d(),m("div",ht,[o("div",null,[o("div",kt,[a[4]||(a[4]=o("span",{class:"text-xs text-gray-500"},"—",-1)),o("span",wt,c(y(r)("games.play.add-tail")),1),a[5]||(a[5]=o("span",{class:"text-xs text-gray-500 flex-1"},"———",-1))]),o("div",Ct,[(d(!0),m(h,null,E(se.value.slice(0,4),e=>(d(),m("button",{key:e.value,onClick:i=>N(e.value),class:S(["py-1 text-[10px] rounded border",w.value===e.value?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"])},c(e.label),11,Et))),128))]),o("div",St,[(d(!0),m(h,null,E(se.value.slice(4,8),e=>(d(),m("button",{key:e.value,onClick:i=>N(e.value),class:S(["py-1 text-[10px] rounded border",w.value===e.value?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"])},c(e.label),11,At))),128))]),o("div",It,[(d(!0),m(h,null,E(se.value.slice(8),e=>(d(),m("button",{key:e.value,onClick:i=>N(e.value),class:S(["py-1 text-[10px] rounded border",w.value===e.value?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"])},c(e.label),11,Nt))),128))])]),o("div",null,[o("div",Gt,[a[6]||(a[6]=o("span",{class:"text-xs text-gray-500"},"—",-1)),o("span",jt,c(y(r)("games.play.add-mod")),1),a[7]||(a[7]=o("span",{class:"text-xs text-gray-500 flex-1"},"———",-1))]),o("div",Mt,[(d(!0),m(h,null,E(Ie.value,e=>(d(),m("button",{key:e.value,onClick:i=>N(e.value),class:S(["py-1 text-[10px] rounded border",w.value===e.value?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"])},c(e.label),11,Bt))),128))]),o("div",$t,[(d(!0),m(h,null,E(Ne.value,e=>(d(),m("button",{key:e.value,onClick:i=>N(e.value),class:S(["py-1 text-[10px] rounded border",w.value===e.value?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"])},c(e.label),11,Tt))),128))]),o("div",Pt,[(d(!0),m(h,null,E(Ge.value,e=>(d(),m("button",{key:e.value,onClick:i=>N(e.value),class:S(["py-1 text-[10px] rounded border",w.value===e.value?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"])},c(e.label),11,Rt))),128))])])])):F("",!0),o("div",Ot,[o("div",Vt,[a[8]||(a[8]=o("span",{class:"text-xs text-gray-500"},"——",-1)),o("span",Lt,c(y(r)("games.play.multiplier")),1),a[9]||(a[9]=o("span",{class:"text-xs text-gray-500 flex-1"},"——————————",-1))]),o("div",qt,[(d(),m(h,null,E(je,e=>o("button",{key:e,onClick:i=>ye(e),class:S(["py-1.5 text-xs rounded border",H.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"])},c(e)+c(y(r)("games.play.times")),11,zt)),64))]),o("div",Ft,[(d(),m(h,null,E(Me,e=>o("button",{key:e,onClick:i=>ye(e),class:S(["py-1.5 text-xs rounded border",H.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"])},c(e)+c(y(r)("games.play.times")),11,Wt)),64))])])],64)):F("",!0),o("button",{onClick:a[0]||(a[0]=e=>R.value=!R.value),class:"w-full mt-3 py-2 bg-orange-500 text-white rounded-lg flex items-center justify-center gap-1"},[U(c(R.value?y(r)("games.play.collapse"):y(r)("games.play.expand"))+" ",1),R.value?(d(),ue(y(ut),{key:0,size:16})):(d(),ue(y(he),{key:1,size:16}))]),o("div",Kt,[o("button",{onClick:ze,class:"py-2 border border-gray-300 rounded-lg text-sm text-gray-600 flex items-center justify-center gap-1"},[U(c(y(r)("games.play.custom-mode"))+" ",1),He(y(he),{size:14})]),o("button",{onClick:We,class:"py-2 border border-gray-300 rounded-lg text-sm text-gray-600"},c(y(r)("games.play.all-in")),1)]),o("div",Qt,[o("div",Ut,[(d(),m(h,null,E(Be,e=>o("button",{key:e.display,onClick:i=>Ve(e.value),class:"w-9 h-9 flex-shrink-0 hover:scale-110 transition-transform"},[o("img",{src:e.img,alt:e.display,class:"w-full h-full object-contain"},null,8,Jt)],8,Dt)),64))]),Xe(o("input",{type:"number","onUpdate:modelValue":a[1]||(a[1]=e=>O.value=e),class:"w-20 h-8 px-2 border border-gray-300 rounded text-sm flex-shrink-0",placeholder:y(r)("games.play.amount")},null,8,Ht),[[Ye,O.value]]),o("button",{onClick:Le,class:"h-8 px-2 bg-red-600 text-white text-xs rounded flex-shrink-0 whitespace-nowrap"},c(y(r)("games.play.fixed-all-in")),1)])])):F("",!0),o("div",Xt,[o("div",Yt,[o("span",null,c(y(r)("games.play.number")),1),o("span",Zt,c(y(r)("games.play.my-bet")),1),o("span",ea,c(y(r)("games.play.bet")),1),a[10]||(a[10]=o("span",null,null,-1))]),J.value?(d(),m("div",ta,[a[11]||(a[11]=o("div",{class:"inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"},null,-1)),o("span",aa,c(y(r)("games.play.loading")),1)])):f.value?(d(),m("div",la,[(d(!0),m(h,null,E(f.value.plays,e=>(d(),m("div",{key:e.id,class:S(["grid grid-cols-[80px_1fr_100px_90px] items-center px-3 py-2",g.value.includes(e.name)?"bg-orange-50":"bg-white"])},[o("div",sa,[o("button",{onClick:i=>be(e),class:S(["w-8 h-8 rounded-full text-white font-bold text-sm flex items-center justify-center",g.value.includes(e.name)?"bg-orange-500":"bg-blue-400"])},c(e.name),11,na),o("span",oa,c((e.odds/1e3).toFixed(2)),1)]),o("div",{class:S(["text-center text-sm",I.value[e.name]>0?"text-red-600 font-medium":"text-gray-400"])},c(I.value[e.name]>0?I.value[e.name].toLocaleString():"-"),3),o("div",null,[o("input",{type:"number",value:x.value[e.name]||"",onInput:i=>Oe(e.name,i.target.value),onFocus:()=>{g.value.includes(e.name)||be(e)},class:"w-full h-8 px-2 border border-gray-300 rounded text-sm text-center",placeholder:""},null,40,ra)]),o("div",ia,[o("button",{onClick:i=>re(e.name,.5),class:"text-xs text-blue-600"},"×0.5",8,ua),o("button",{onClick:i=>re(e.name,2),class:"text-xs text-blue-600"},"×2",8,ca),o("button",{onClick:i=>re(e.name,10),class:"text-xs text-blue-600"},"×10",8,da)])],2))),128))])):(d(),m("div",ma,c(y(r)("games.play.no-plays")),1))]),o("div",pa,[j.value?(d(),m("div",va,[o("div",ga,[o("span",fa,c(y(r)("games.play.last-period-label")),1),o("span",ba,c(j.value.expect_no||"--"),1)]),o("div",ya,[o("span",xa,c(Pe()),1)]),o("div",_a,c(j.value.open_time||""),1)])):F("",!0),o("div",ha,[o("div",ka,[o("span",wa,c(y(r)("games.play.total-bet")),1),o("span",Ca,c(Object.values(I.value).reduce((e,i)=>e+i,0).toLocaleString()),1),a[12]||(a[12]=o("img",{alt:"coin",class:"inline-block w-4 h-4 ml-0.5",src:xe},null,-1))]),o("div",Ea,[o("span",Sa,c(y(r)("games.play.this-bet")),1),o("span",Aa,c(ne.value.toLocaleString()),1),a[13]||(a[13]=o("img",{alt:"coin",class:"inline-block w-4 h-4 ml-0.5",src:xe},null,-1))])]),o("div",Ia,[o("button",{onClick:Qe,class:"bg-blue-600 text-white font-bold flex items-center justify-center gap-1"},[a[14]||(a[14]=o("span",{class:"text-lg"},"<",-1)),U(" "+c(y(r)("games.play.cancel")),1)]),o("button",Na,[T.value>0?(d(),m(h,{key:0},[o("span",Ga,c(y(r)("games.play.close-countdown")),1),o("span",ja,c(fe(T.value)),1)],64)):(d(),m(h,{key:1},[o("span",Ma,c(y(r)("games.play.open-countdown")),1),o("span",Ba,c(fe($.value)),1)],64))]),o("button",{onClick:Ke,disabled:Z.value===3001||ne.value<=0,class:S(["font-bold flex items-center justify-center gap-1",Z.value===3001||ne.value<=0?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-red-600 text-white"])},[a[15]||(a[15]=o("span",{class:"text-lg"},"✓",-1)),U(" "+c(y(r)("games.play.submit-bet")),1)],10,$a)])]),(d(),ue(et,{to:"body"},[M.value?(d(),m("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:a[3]||(a[3]=Ze(e=>M.value=!1,["self"]))},[o("div",Ta,[o("div",Pa,c(y(r)("games.play.select-mode")),1),o("div",Ra,[X.value?(d(),m("div",Oa,[a[16]||(a[16]=o("div",{class:"inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-red-600 border-r-transparent"},null,-1)),o("span",Va,c(y(r)("games.play.loading")),1)])):B.value.length===0?(d(),m("div",La,[o("p",null,c(y(r)("games.play.no-modes")),1),o("p",qa,c(y(r)("games.play.create-mode-hint")),1)])):(d(),m("div",za,[(d(!0),m(h,null,E(B.value,e=>(d(),m("button",{key:e.id,onClick:i=>Fe(e),class:S(["w-full px-4 py-3 text-left hover:bg-gray-50 flex justify-between items-center",Y.value?.id===e.id&&"bg-orange-50"])},[o("span",Wa,c(e.mode_name),1),o("span",Ka,c(e.bet_gold),1)],10,Fa))),128))]))]),o("div",Qa,[o("button",{onClick:a[2]||(a[2]=e=>M.value=!1),class:"w-full py-2 bg-gray-200 text-gray-700 rounded-lg"},c(y(r)("games.play.close")),1)])])])):F("",!0)]))]))}});export{al as default};
