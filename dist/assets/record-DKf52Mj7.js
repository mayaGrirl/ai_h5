import{d as C,w as A,o as R,q as n,n as s,x as t,y as l,r as b,C as x,F as L,t as N,L as M,l as d,u as y}from"./vue-vendor-2ZNhN7Rr.js";import{a as z,t as B}from"./index-CIZoSaJ3.js";import{a as D}from"./game-uyk3Yxtn.js";import"./utils-vendor-CbLx3nH2.js";const F={class:"bg-gray-100 pb-16"},V={class:"bg-white mx-3 my-3 rounded-lg shadow"},$={class:"grid grid-cols-[1.2fr_1.5fr_1fr] text-xs text-gray-500 border-b bg-gray-50 px-3 py-2 gap-2 rounded-t-lg"},E={class:"text-center"},G={class:"text-center"},O={key:0,class:"flex justify-center items-center py-8"},H={class:"ml-2 text-gray-600"},J={key:1,class:"text-center py-8 text-gray-500"},K={key:2,class:"divide-y"},P={class:"grid grid-cols-[1.2fr_1.5fr_1fr] items-start gap-2"},Q={class:"text-sm text-blue-700 font-medium truncate"},T={class:"text-[10px] text-gray-400 mt-1"},U={class:"text-[10px] mt-1"},W={class:"text-gray-500"},X={class:"text-center"},Y={key:0,class:"text-gray-400"},Z={key:1,class:"space-y-1"},ee={class:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded"},te={class:"text-gray-500"},se={key:2,class:"text-gray-400 text-xs text-center"},oe={class:"text-center"},re={class:"text-blue-600 font-medium"},ae={key:0,class:"mt-2 pt-2 border-t border-dashed flex justify-between items-center text-xs"},ne={class:"text-gray-500"},de={key:0,class:"py-4 text-center"},le=["disabled"],ce={key:1,class:"py-4 text-center text-gray-400 text-sm"},I=15,ye=C({__name:"record",setup(ie){const{t:o}=z(),p=M(),i=b([]),g=b(!1),v=b(1),f=b(!0),S=()=>Number(p.query.lottery_id)||0,j=()=>Number(p.query.group_id)||0,h=async(c=1,a=!1)=>{const e=S(),u=j();if(e)try{g.value=!0;const r=await D({lottery_id:e,game_group_id:u,page:c,pageSize:I});if(r.code===200&&r.data){const _=r.data.list||[];a?i.value=_:i.value=[...i.value,..._],f.value=_.length>=I,v.value=c}else B.error(r.message||o("games.record.load-failed")),a&&(i.value=[])}catch{B.error(o("games.record.load-failed-retry")),a&&(i.value=[])}finally{g.value=!1}},q=()=>{g.value||!f.value||h(v.value+1,!1)},w=c=>{if(!Array.isArray(c)||c.length===0)return[];const a=c.filter(r=>(r.win_gold||0)>0),e=c.filter(r=>(r.win_gold||0)<=0),u=[];for(const r of a)u.length<3&&u.push(r);for(const r of e)u.length<3&&u.push(r);return u},m=c=>{const a=c.bet_no;return a?Array.isArray(a)?a:typeof a=="object"?Object.values(a):[]:[]},k=c=>{switch(Number(c.status)){case 0:return{text:o("games.record.unsettled"),color:"text-orange-600 bg-orange-50"};case 1:return c.is_win===2?{text:o("games.record.won"),color:"text-red-600 bg-red-50"}:{text:o("games.record.not-won"),color:"text-gray-600 bg-gray-100"};case 2:return{text:o("games.record.rolled-back"),color:"text-yellow-600 bg-yellow-50"};case 3:return{text:o("games.record.deleted"),color:"text-gray-400 bg-gray-100"};default:return{text:"--",color:"text-gray-500"}}};return A(()=>[p.query.lottery_id,p.query.group_id],()=>{h(1,!0)}),R(()=>{h(1,!0)}),(c,a)=>(d(),n("div",F,[s("div",V,[s("div",$,[s("span",null,t(l(o)("games.record.period-time")),1),s("span",E,t(l(o)("games.record.bet-details")),1),s("span",G,t(l(o)("games.record.amount-status")),1)]),g.value&&i.value.length===0?(d(),n("div",O,[a[0]||(a[0]=s("div",{class:"inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"},null,-1)),s("span",H,t(l(o)("games.record.loading")),1)])):i.value.length===0?(d(),n("div",J,t(l(o)("games.record.no-data")),1)):(d(),n("div",K,[(d(!0),n(L,null,N(i.value,(e,u)=>(d(),n("div",{key:`${e.id}-${u}`,class:y(["px-3 py-3 text-xs",e.is_win===2?"bg-yellow-50":"bg-white"])},[s("div",P,[s("div",null,[s("div",Q,t(e.expect_no||"--"),1),s("div",T,t(e.bet_time||e.created_at||""),1),s("div",U,[s("span",W,t(l(o)("games.record.auto")),1),s("span",{class:y(e.is_auto===1?"text-green-600":"text-red-500")},t(e.is_auto===1?"√":"×"),3)])]),s("div",X,[w(m(e)).length===0?(d(),n("span",Y,"--")):(d(),n("div",Z,[(d(!0),n(L,null,N(w(m(e)),(r,_)=>(d(),n("div",{key:_,class:"flex items-center justify-center gap-1 text-xs"},[s("span",ee,t(r.bet_no||"--"),1),s("span",te," x "+t(r.win_gold||0),1)]))),128))])),m(e).length>3?(d(),n("div",se,"......")):x("",!0)]),s("div",oe,[s("div",re,t(l(o)("games.record.bet-amount"))+t((e.bet_gold||0).toLocaleString()),1),e.is_opened===1?(d(),n("div",{key:0,class:y(e.win_gold&&e.win_gold>0?"text-red-600 font-medium":"text-gray-400")},t(l(o)("games.record.win-amount"))+t((e.win_gold||0).toLocaleString()),3)):x("",!0),s("div",{class:y(["inline-block px-2 py-0.5 rounded text-[10px] mt-1",k(e).color])},t(k(e).text),3)])]),e.is_opened===1?(d(),n("div",ae,[s("span",ne,t(l(o)("games.record.total"))+t(e.bet_num||m(e).length)+t(l(o)("games.record.bets")),1),s("span",{class:y((e.win_loss||0)>=0?"text-red-600 font-medium":"text-green-600 font-medium")},t(l(o)("games.record.profit-loss"))+" "+t((e.win_loss||0)>=0?"+":"")+t((e.win_loss||0).toLocaleString()),3)])):x("",!0)],2))),128)),f.value?(d(),n("div",de,[s("button",{onClick:q,disabled:g.value,class:"px-6 py-2 bg-red-600 text-white text-sm rounded-lg disabled:opacity-50"},t(g.value?l(o)("common.loading"):l(o)("games.record.load-more")),9,le)])):x("",!0),!f.value&&i.value.length>0?(d(),n("div",ce,t(l(o)("games.record.no-more")),1)):x("",!0)]))])]))}});export{ye as default};
