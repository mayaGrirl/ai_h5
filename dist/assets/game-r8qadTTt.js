import{j as A,c as _,r}from"./vue-vendor-ntQnFNWs.js";import{g as b,p as E}from"./game-C2B051S4.js";const P=A("game",()=>{const d=r("加载中..."),g=r([]),f=r(null),m=r(!1),v=r(!0),s=r([]),l=r(0),h=r(!1),G=()=>{if(typeof window<"u"){const e=localStorage.getItem("game_sound_enabled");h.value=e==="true"}},S=e=>{h.value=e,typeof window<"u"&&localStorage.setItem("game_sound_enabled",e?"true":"false")},w=_(()=>!l.value||s.value.length===0?"":s.value.find(a=>a.id===l.value)?.name||""),y=async(e,a)=>{try{v.value=!0;const t=await b({});if(t.code===200&&t.data){const{gameTypeMap:i=[]}=t.data,u=[];(Array.isArray(i)?i:[]).forEach(o=>{o.children&&Array.isArray(o.children)&&o.children.forEach(c=>{(c.is_show===void 0||c.is_show===1)&&u.push(c)})}),g.value=u;let n=null;if(e&&(n=u.find(o=>String(o.id)===String(e))||null),!n&&u.length>0&&(n=u[0]),n){f.value=n,d.value=n.name;const o=await p(n.id),c=a?Number(a):o.length>0?o[0].id:0;l.value=c}}}catch(t){console.error("获取游戏列表失败:",t)}finally{v.value=!1}},p=async e=>{try{const a=await E({lottery_id:e});if(a.code===200&&a.data){const t=(a.data.groupArr||[]).filter(i=>i.status===1);return s.value=t,t}else return s.value=[],[]}catch(a){return console.error("获取玩法分组失败",a),s.value=[],[]}};return{gameName:d,allGames:g,activeGame:f,showGameSelector:m,isLoadingGames:v,playGroups:s,selectedGroupId:l,soundEnabled:h,currentGroupName:w,initSoundSetting:G,setSoundEnabled:S,fetchGameAll:y,fetchPlayGroups:p,handleGameSwitch:async e=>{m.value=!1,f.value=e,d.value=e.name;const a=await p(e.id),t=a.length>0?a[0].id:0;return l.value=t,t},setSelectedGroupId:e=>{l.value=e},setShowGameSelector:e=>{m.value=e}}});export{P as u};
