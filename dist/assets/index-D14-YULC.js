import{d as M,o as P,q as o,r as f,l as s,z as u,u as _,F as C,t as A,I as q,B as F,v as r,x as S}from"./vue-vendor-ntQnFNWs.js";import{a as R,t as b}from"./index-FdFg60UN.js";import{g as T,p as D}from"./game-D5Zp6FTN.js";import{u as E}from"./useLocalized-CieMjQc2.js";import"./utils-vendor-CbLx3nH2.js";import"./index-C6jzfBHC.js";const N={key:0,class:"flex min-h-screen justify-center items-center bg-zinc-50"},V={class:"text-center"},H={class:"mt-3 text-gray-600"},J={key:1,class:"flex min-h-screen justify-center items-center bg-zinc-50"},K={class:"text-center"},O={class:"text-gray-600"},Q={key:2,class:"flex min-h-screen justify-center bg-zinc-50"},U={class:"w-full max-w-3xl bg-white"},W={class:"h-16 flex items-center justify-center bg-red-600 text-white"},X={class:"text-white text-2xl font-black tracking-wide"},Y={class:"w-full overflow-x-auto whitespace-nowrap border-b py-3 px-4 bg-red-50"},Z={class:"flex gap-4"},ee=["onClick"],te={class:"flex"},se={class:"w-28 border-r p-3 flex flex-col gap-3 bg-gray-50 min-h-[70vh]"},ae=["onClick"],le={class:"flex-1 p-4"},ne={class:"text-lg font-bold mb-3"},oe={key:0,class:"flex justify-center items-center py-8"},re={class:"ml-2 text-gray-600"},ie={key:1,class:"text-center py-8 text-gray-500"},de={key:2,class:"grid grid-cols-2 gap-3"},ce=["onClick"],ue={class:"font-medium"},ye=M({__name:"index",setup(_e){const{t:d}=R(),{localize:p}=E(),j=q(),L=F(),z=f([]),h=f(null),c=f(null),v=f([]),x=f(!0),w=f(!1),G=async()=>{try{x.value=!0;const a=j.query.lottery_id,t=await T({});if(t.code===200&&t.data){const{gameTypeMap:e=[]}=t.data,g=(Array.isArray(e)?e:[]).filter(n=>n.children&&Array.isArray(n.children)&&n.children.length>0).map(n=>{const y=n.children.filter(l=>l.is_show===void 0||l.is_show===1).map(l=>({id:l.id,name:l.name,logo:l.logo,lang_name:l.lang_name,game_class:l.game_class,is_hot:l.is_hot,is_show:l.is_show,info:l.info,lang_info:l.lang_info}));return{id:n.id,name:n.title,lang_title:n.lang_title,games:y}}).filter(n=>n.games.length>0);z.value=g;let i=null,m=null;if(a)for(const n of g){const y=n.games.find(l=>String(l.id)===String(a));if(y){i=n,m=y;break}}i||(i=g[0]),m||(m=i?.games[0]||null),h.value=i,c.value=m,m&&await k(m.id)}else b.error(t.message||d("games.load-failed"))}catch{b.error(d("games.load-failed-retry"))}finally{x.value=!1}},k=async a=>{try{w.value=!0;const t=await D({lottery_id:a});if(t.code===200&&t.data){const{groupArr:e=[]}=t.data,g=e.filter(i=>i.status===1).map(i=>({id:i.id,name:i.name,lang_name:i.lang_name}));v.value=g}else b.error(t.message||d("games.group-load-failed")),v.value=[]}catch{b.error(d("games.group-load-failed-retry")),v.value=[]}finally{w.value=!1}},$=a=>{if(h.value=a,a.games.length>0){const t=a.games[0];c.value=t,k(t.id)}},B=a=>{c.value=a,k(a.id)},I=a=>{c.value&&L.push(`/games/play?lottery_id=${c.value.id}&group_id=${a}`)};return P(()=>{G()}),(a,t)=>x.value?(r(),o("div",N,[s("div",V,[t[0]||(t[0]=s("div",{class:"inline-block h-8 w-8 animate-spin rounded-full border-4 border-solid border-red-600 border-r-transparent"},null,-1)),s("p",H,u(_(d)("games.loading")),1)])])):!h.value||!c.value?(r(),o("div",J,[s("div",K,[s("p",O,u(_(d)("games.no-data")),1),s("button",{onClick:G,class:"mt-4 px-4 py-2 bg-red-600 text-white rounded-lg"},u(_(d)("games.reload")),1)])])):(r(),o("div",Q,[s("main",U,[s("header",W,[s("span",X,u(_(d)("games.hall")),1)]),s("div",Y,[s("div",Z,[(r(!0),o(C,null,A(z.value,e=>(r(),o("button",{key:e.id,onClick:g=>$(e),class:S(["px-4 py-2 rounded-full text-sm",h.value?.id===e.id?"bg-red-600 text-white":"bg-white text-red-600 border border-red-600"])},u(_(p)(e.lang_title,e.name)),11,ee))),128))])]),s("div",te,[s("div",se,[(r(!0),o(C,null,A(h.value?.games,e=>(r(),o("button",{key:e.id,onClick:g=>B(e),class:S(["text-sm p-2 rounded",c.value?.id===e.id?"bg-blue-600 text-white":"bg-blue-50 text-blue-600"])},u(_(p)(e.lang_name,e.name)),11,ae))),128))]),s("div",le,[s("h2",ne,u(c.value?_(p)(c.value.lang_name,c.value.name):""),1),w.value?(r(),o("div",oe,[t[1]||(t[1]=s("div",{class:"inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"},null,-1)),s("span",re,u(_(d)("games.group-loading")),1)])):v.value.length===0?(r(),o("div",ie,u(_(d)("games.group-no-data")),1)):(r(),o("div",de,[(r(!0),o(C,null,A(v.value,e=>(r(),o("button",{key:e.id,onClick:g=>I(e.id),class:"p-4 bg-gray-100 rounded-lg text-center text-gray-900 hover:bg-gray-200 transition cursor-pointer"},[s("div",ue,u(_(p)(e.lang_name,e.name)),1)],8,ce))),128))]))])])])]))}});export{ye as default};
