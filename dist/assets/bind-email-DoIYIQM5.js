import{d as k,o as C,r as n,q as c,f as v,n as e,y as t,x as u,M as S,C as b,S as E,U as M,u as h,l as d,D as V}from"./vue-vendor-2ZNhN7Rr.js";import{a as B,u as D,C as N,t as f}from"./index-DBwKxXoa.js";import{e as R}from"./customer-D1FIUO_K.js";import{_ as A}from"./PageHeader.vue_vue_type_script_setup_true_lang-D0JAJ2ep.js";import"./utils-vendor-CbLx3nH2.js";import"./index-C6jzfBHC.js";import"./chevron-left-O4KYKsVf.js";const U={class:"min-h-screen bg-[#f5f7fb] pb-16"},$={class:"px-3 pb-20 pt-3"},q={class:"p-3 bg-red-50 border border-red-200 rounded-lg flex items-center gap-2"},z={class:"text-red-600 text-sm"},I={class:"bg-white rounded-xl shadow-sm p-3"},T={class:"flex items-center gap-2"},j={class:"text-gray-700 w-12 flex-shrink-0"},F=["placeholder","disabled"],G={key:0,class:"mt-1 text-xs text-red-500"},H=["disabled"],Y=k({__name:"bind-email",setup(J){const _=V(),{t:a}=B(),p=D(),s=n(""),r=n(""),l=n(!1),i=n(!1),x=o=>/^[\w\-\.]+@[\w\-]+(\.\w+)+$/.test(o),g=()=>(r.value="",s.value.trim()?x(s.value)?s.value.length>50?(r.value="邮箱最多50个字符",!1):!0:(r.value="邮箱格式不正确",!1):(r.value="请输入邮箱",!1)),w=async()=>{if(g()){l.value=!0;try{const o=await R({email:s.value});o.code===200?(f.success(o.message||"绑定成功"),_.back()):f.error(o.message||"绑定失败")}catch{f.error("绑定失败")}finally{l.value=!1}}};return C(()=>{p.currentCustomer?.email&&(s.value=p.currentCustomer.email,i.value=!0)}),(o,m)=>(d(),c("div",U,[v(A,{title:t(a)("mine.bind-email.title")},null,8,["title"]),e("main",$,[e("div",q,[v(t(N),{class:"w-5 h-5 text-red-500 flex-shrink-0"}),e("span",z,u(t(a)("mine.bind-email.alert")),1)]),e("form",{onSubmit:S(w,["prevent"]),class:"mt-5"},[e("div",I,[e("div",T,[e("label",j,u(t(a)("mine.profile.form-label.email")),1),E(e("input",{"onUpdate:modelValue":m[0]||(m[0]=y=>s.value=y),type:"text",placeholder:t(a)("common.form.placeholder.enter")+t(a)("mine.profile.form-label.email"),disabled:i.value,class:h(["flex-1 placeholder-gray-400 focus:outline-none h-12",i.value?"text-gray-400":"text-gray-800"])},null,10,F),[[M,s.value]])]),r.value?(d(),c("p",G,u(r.value),1)):b("",!0)]),i.value?b("",!0):(d(),c("button",{key:0,type:"submit",disabled:l.value,class:h(["mt-10 h-12 w-full rounded-full bg-gradient-to-r from-[#ff6a3a] to-[#ff1020] text-white font-medium tracking-wide transition transform active:scale-95",l.value?"opacity-60 cursor-not-allowed":"cursor-pointer"])},u(l.value?t(a)("common.form.button.submitting"):t(a)("common.form.button.submit")),11,H))],32)])]))}});export{Y as default};
