import{d as D,w as R,o as U,q as d,l as e,k as E,J as N,z as a,u as o,Q as S,R as M,r as c,f as F,x as G,K as T,F as J,t as K,p as O,I as Q,v as i}from"./vue-vendor-ntQnFNWs.js";import{a as H,t as m}from"./index-CxBbivxG.js";import{d as P,m as W,e as X}from"./game-Dbb4ZBoF.js";import{C as Y}from"./chevron-right-COdj1xIn.js";import"./utils-vendor-CbLx3nH2.js";const Z={class:"bg-gray-100 pb-32"},ee={class:"space-y-3 mt-3"},te={class:"bg-white mx-3 rounded-lg shadow"},se={class:"px-4 py-3 text-gray-500 text-sm font-medium border-b"},oe={class:"flex justify-between items-center px-4 py-3 border-b"},ae={class:"text-sm"},ne={class:"flex items-center gap-2"},le={class:"text-gray-500 text-sm"},re={class:"flex justify-between items-center px-4 py-3 border-b"},ie={class:"text-sm"},de=["placeholder"],ue={class:"flex justify-between items-center px-4 py-3 border-b"},ce={class:"text-sm"},me=["placeholder"],ge={class:"text-sm"},pe={class:"flex items-center gap-2 text-gray-500"},ve={key:0,class:"text-red-600 font-medium"},_e={key:1,class:"text-gray-400"},xe={key:0,class:"bg-white mx-3 rounded-lg shadow px-4 py-3"},ye={class:"flex justify-between items-center"},fe={class:"text-sm"},be={class:"mx-3 p-3 bg-yellow-50 rounded-lg border border-yellow-200"},he={class:"text-center text-gray-500 text-sm mb-2"},we={class:"text-xs text-gray-600 leading-relaxed space-y-1"},ke={class:"fixed bottom-14 left-0 right-0 bg-white p-4 border-t shadow-lg"},Ce={class:"flex gap-3"},Ie=["disabled"],Ne=["disabled"],Se={class:"mx-4 w-full max-w-sm rounded-lg bg-white flex flex-col max-h-[70vh]"},Me={class:"p-3 border-b font-medium"},je={class:"flex-1 overflow-y-auto"},qe={key:0,class:"text-center py-8 text-gray-500"},Ve={class:"text-sm mt-2"},$e={key:1,class:"divide-y"},ze=["onClick"],Ge={class:"flex items-center gap-5 font-medium"},Le={class:"text-xs text-gray-500 mt-1"},Ae={class:"text-xs text-gray-500 mt-1"},Be={key:0,class:"text-red-600 text-sm"},De={class:"p-3 border-t"},Ke=D({__name:"auto",setup(Re){const{t}=H(),w=Q(),p=c([]),x=c(!1),y=c("1"),f=c(""),b=c(""),u=c(null),v=c(0),k=c(null),j=c(!1),_=c(!1),C=()=>Number(w.query.lottery_id)||0,q=()=>Number(w.query.group_id)||0,L=async()=>{const r=C(),n=q();if(!r)return[];try{const s=await W({lottery_id:r,game_group_id:n,page:1,pageSize:100});if(s.code===200&&s.data){const l=s.data.list||[];return p.value=l,l}else return p.value=[],[]}catch(s){return console.error("获取模式列表失败",s),p.value=[],[]}},V=async r=>{const n=C();if(n)try{j.value=!0;const s=await X({lottery_id:n});if(s.code===200&&s.data&&s.data.id){const l=s.data;k.value=l,y.value=String(l.total_expect_nums||1),f.value=String(l.min_gold||""),b.value=String(l.max_gold||""),v.value=l.status||0;const h=l.mode_id||l.auto_id;if(h){const g=(r||p.value).find(B=>B.id===h);g&&(u.value=g)}}else k.value=null,y.value="1",f.value="",b.value="",u.value=null,v.value=0}catch(s){console.error("获取自动配置失败",s)}finally{j.value=!1}},A=r=>{u.value=r,x.value=!1},$=async r=>{const n=C(),s=q();if(!n){m.error(t("games.auto.select-game"));return}if(!s){m.error(t("games.auto.select-group"));return}if(!u.value){m.error(t("games.auto.select-mode-required"));return}const l=parseInt(y.value,10);if(isNaN(l)||l<1){m.error(t("games.auto.periods-min"));return}if(l>1440){m.error(t("games.auto.periods-max"));return}const h=parseInt(f.value,10)||0,I=parseInt(b.value,10)||0;if(h<0||I<0){m.error(t("games.auto.coins-negative"));return}try{_.value=!0;const g=await P({lottery_id:n,game_group_id:s,mode_id:u.value.id,total_expect_nums:l,min_gold:h,max_gold:I,status:r});g.code===200?(m.success(t(r===1?"games.auto.start-success":"games.auto.stop-success")),v.value=r,await V()):m.error(g.message||t("games.auto.operation-failed"))}catch(g){console.error("操作失败",g),m.error(t("games.auto.operation-failed-retry"))}finally{_.value=!1}},z=async()=>{const r=await L();await V(r)};return R(()=>[w.query.lottery_id,w.query.group_id],()=>{z()}),U(()=>{z()}),(r,n)=>(i(),d("div",Z,[e("div",ee,[e("div",te,[e("div",se,a(o(t)("games.auto.basic-settings")),1),e("div",oe,[e("span",ae,a(o(t)("games.auto.periods")),1),e("div",ne,[S(e("input",{type:"number","onUpdate:modelValue":n[0]||(n[0]=s=>y.value=s),placeholder:"1-1440",min:"1",max:"1440",class:"w-24 px-3 py-2 text-sm border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-red-500"},null,512),[[M,y.value]]),e("span",le,a(o(t)("games.auto.period-unit")),1)])]),e("div",re,[e("span",ie,a(o(t)("games.auto.min-coins")),1),S(e("input",{type:"number","onUpdate:modelValue":n[1]||(n[1]=s=>f.value=s),placeholder:o(t)("games.auto.min-coins-hint"),class:"w-40 px-3 py-2 text-sm border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-red-500"},null,8,de),[[M,f.value]])]),e("div",ue,[e("span",ce,a(o(t)("games.auto.max-coins")),1),S(e("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=s=>b.value=s),placeholder:o(t)("games.auto.max-coins-hint"),class:"w-40 px-3 py-2 text-sm border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-red-500"},null,8,me),[[M,b.value]])]),e("div",{class:"flex justify-between items-center px-4 py-3 cursor-pointer hover:bg-gray-50",onClick:n[3]||(n[3]=s=>x.value=!0)},[e("span",ge,a(o(t)("games.auto.bet-mode")),1),e("div",pe,[u.value?(i(),d("span",ve,a(u.value.mode_name),1)):(i(),d("span",_e,a(o(t)("games.auto.select-mode")),1)),F(o(Y),{size:16})])])]),k.value?(i(),d("div",xe,[e("div",ye,[e("span",fe,a(o(t)("games.auto.current-status")),1),e("span",{class:G(["px-3 py-1 rounded-full text-xs font-medium",v.value===1?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"])},a(v.value===1?o(t)("games.auto.running"):o(t)("games.auto.closed")),3)])])):N("",!0),e("div",be,[e("div",he,a(o(t)("games.auto.settings-title")),1),e("div",we,[e("p",null,a(o(t)("games.auto.instruction-1")),1),e("p",null,a(o(t)("games.auto.instruction-2")),1),e("p",null,a(o(t)("games.auto.instruction-3")),1),e("p",null,a(o(t)("games.auto.instruction-4")),1),e("p",null,a(o(t)("games.auto.instruction-5")),1)])])]),e("div",ke,[e("div",Ce,[v.value===1?(i(),d("button",{key:0,onClick:n[4]||(n[4]=s=>$(0)),disabled:_.value,class:"flex-1 h-12 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50"},a(_.value?o(t)("games.auto.processing"):o(t)("games.auto.stop")),9,Ie)):(i(),d("button",{key:1,onClick:n[5]||(n[5]=s=>$(1)),disabled:_.value||!u.value,class:"flex-1 h-12 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50"},a(_.value?o(t)("games.auto.processing"):o(t)("games.auto.start")),9,Ne))])]),(i(),E(O,{to:"body"},[x.value?(i(),d("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:n[7]||(n[7]=T(s=>x.value=!1,["self"]))},[e("div",Se,[e("div",Me,a(o(t)("games.play.select-mode")),1),e("div",je,[p.value.length===0?(i(),d("div",qe,[e("p",null,a(o(t)("games.play.no-modes")),1),e("p",Ve,a(o(t)("games.play.create-mode-hint")),1)])):(i(),d("div",$e,[(i(!0),d(J,null,K(p.value,s=>(i(),d("button",{key:s.id,onClick:l=>A(s),class:G(["w-full px-4 py-3 text-left hover:bg-gray-50 flex justify-between items-center",u.value?.id===s.id&&"bg-red-50"])},[e("div",null,[e("div",Ge,[e("span",null,a(s.mode_name),1),e("span",null,a(s.bet_gold),1)]),e("div",Le,a(o(t)("games.mode.play-method"))+" "+a(s.bet_no),1),e("div",Ae,a(o(t)("games.mode.coins"))+" "+a(s.bet_no_gold),1)]),u.value?.id===s.id?(i(),d("span",Be,a(o(t)("common.selected")),1)):N("",!0)],10,ze))),128))]))]),e("div",De,[e("button",{onClick:n[6]||(n[6]=s=>x.value=!1),class:"w-full py-2 bg-gray-200 text-gray-700 rounded-lg"},a(o(t)("games.play.close")),1)])])])):N("",!0)]))]))}});export{Ke as default};
