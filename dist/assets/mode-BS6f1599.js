import{d as V,w as B,o as E,q as i,n as e,k as P,f as b,y as o,x as l,r as m,C as k,F,t as R,M as S,m as G,D as H,L as A,l as d}from"./vue-vendor-2ZNhN7Rr.js";import{c as M,a as J,t as w}from"./index-BFniYAsS.js";import{m as K,s as O}from"./game-Cxn9jYzg.js";import"./utils-vendor-CbLx3nH2.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=M("PenIcon",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=M("PlusIcon",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W=M("Trash2Icon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),X={class:"bg-gray-100 pb-16"},Y={class:"bg-white mx-3 my-3 rounded-lg shadow"},Z={class:"bg-white mx-3 my-3 rounded-lg shadow"},ee={class:"grid grid-cols-[1fr_80px_80px] text-xs text-gray-500 border-b bg-gray-50 px-3 py-2 gap-2 rounded-t-lg"},te={class:"text-center"},se={class:"text-center"},oe={key:0,class:"flex justify-center items-center py-8"},ae={class:"ml-2 text-gray-600"},le={key:1,class:"text-center py-8 text-gray-500"},ne={key:2,class:"divide-y"},re={class:"grid grid-cols-[1fr_80px_80px] items-center gap-2"},de={class:"font-medium text-gray-800 truncate"},ie={class:"text-center text-red-600 font-medium"},ce={class:"flex justify-center gap-1"},ue=["onClick","title"],me=["onClick","title"],ge={class:"mt-2 text-xs text-gray-500"},_e={class:"flex items-start gap-1"},pe={class:"text-gray-400 flex-shrink-0"},ye={class:"line-clamp-2 break-all"},ve={class:"flex items-start gap-1 mt-1"},he={class:"text-gray-400 flex-shrink-0"},fe={class:"line-clamp-1 break-all"},xe={key:0,class:"py-4 text-center"},be=["disabled"],ke={key:1,class:"py-4 text-center text-gray-400 text-sm"},we={class:"mx-4 w-full max-w-sm rounded-lg bg-white p-4"},Me={class:"text-lg font-medium mb-2"},Ce={class:"text-gray-600 mb-4"},Ie={class:"flex gap-3"},N=20,qe=V({__name:"mode",setup(Le){const{t}=J(),p=A(),C=H(),r=m([]),c=m(!1),I=m(1),y=m(!0),g=m(!1),u=m(null),v=()=>Number(p.query.lottery_id)||0,L=()=>Number(p.query.group_id)||0,$=a=>{const s=typeof a=="string"?parseInt(a,10):a;return isNaN(s)?"0":new Intl.NumberFormat("zh-CN").format(s)},h=async(a=1,s=!1)=>{const n=v(),f=L();if(n)try{c.value=!0;const _=await K({lottery_id:n,game_group_id:f,page:a,pageSize:N});if(_.code===200&&_.data){const x=_.data.list||[];s?r.value=x:r.value=[...r.value,...x],y.value=x.length>=N,I.value=a}else s&&(r.value=[])}catch(_){console.error("获取模式列表失败:",_),s&&(r.value=[])}finally{c.value=!1}},z=()=>{c.value||!y.value||h(I.value+1,!1)},j=async()=>{if(u.value)try{const a=await O({id:u.value.id,status:0});a.code===200?(w.success(t("games.mode.delete-success")),r.value=r.value.filter(s=>s.id!==u.value?.id)):w.error(a.message||t("games.mode.delete-failed"))}catch(a){const n=a?.response?.data?.message;w.error(n||t("games.mode.delete-failed-retry"))}finally{g.value=!1,u.value=null}},q=a=>{u.value=a,g.value=!0},D=()=>{const a=v(),s=L();C.push(`/games/mode/edit?lottery_id=${a}&group_id=${s}`)},T=a=>{const s=v();C.push(`/games/mode/edit?lottery_id=${s}&group_id=${a.game_group_id}&mode_id=${a.id}`)};return B(()=>[p.query.lottery_id,p.query.group_id],()=>{h(1,!0)}),E(()=>{h(1,!0)}),(a,s)=>(d(),i("div",X,[e("div",Y,[e("button",{onClick:D,class:"w-full flex items-center justify-center gap-2 py-4 text-red-600 hover:bg-red-50"},[b(o(U),{size:20}),e("span",null,l(o(t)("games.mode.create")),1)])]),e("div",Z,[e("div",ee,[e("span",null,l(o(t)("games.mode.name")),1),e("span",te,l(o(t)("games.mode.total-coins")),1),e("span",se,l(o(t)("games.mode.operations")),1)]),c.value&&r.value.length===0?(d(),i("div",oe,[s[2]||(s[2]=e("div",{class:"inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"},null,-1)),e("span",ae,l(o(t)("games.mode.loading")),1)])):r.value.length===0?(d(),i("div",le,l(o(t)("games.mode.no-data")),1)):(d(),i("div",ne,[(d(!0),i(F,null,R(r.value,n=>(d(),i("div",{key:n.id,class:"px-3 py-3 text-sm bg-white hover:bg-gray-50"},[e("div",re,[e("div",de,l(n.mode_name),1),e("div",ie,l($(n.bet_gold)),1),e("div",ce,[e("button",{onClick:f=>T(n),class:"p-1.5 text-blue-600 hover:bg-blue-50 rounded",title:o(t)("games.mode.edit")},[b(o(Q),{size:16})],8,ue),e("button",{onClick:f=>q(n),class:"p-1.5 text-red-600 hover:bg-red-50 rounded",title:o(t)("games.mode.delete")},[b(o(W),{size:16})],8,me)])]),e("div",ge,[e("div",_e,[e("span",pe,l(o(t)("games.mode.play-method")),1),e("span",ye,l(n.bet_no),1)]),e("div",ve,[e("span",he,l(o(t)("games.mode.coins")),1),e("span",fe,l(n.bet_no_gold),1)])])]))),128)),y.value?(d(),i("div",xe,[e("button",{onClick:z,disabled:c.value,class:"px-6 py-2 bg-red-600 text-white text-sm rounded-lg disabled:opacity-50"},l(c.value?o(t)("common.loading"):o(t)("games.mode.load-more")),9,be)])):k("",!0),!y.value&&r.value.length>0?(d(),i("div",ke,l(o(t)("games.mode.no-more")),1)):k("",!0)]))]),(d(),P(G,{to:"body"},[g.value?(d(),i("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:s[1]||(s[1]=S(n=>g.value=!1,["self"]))},[e("div",we,[e("div",Me,l(o(t)("games.mode.delete-confirm")),1),e("div",Ce,l(o(t)("games.mode.delete-confirm-msg"))+' "'+l(u.value?.mode_name)+'"? ',1),e("div",Ie,[e("button",{onClick:s[0]||(s[0]=n=>g.value=!1),class:"flex-1 py-2 bg-gray-200 text-gray-700 rounded-lg"},l(o(t)("common.cancel")),1),e("button",{onClick:j,class:"flex-1 py-2 bg-red-600 text-white rounded-lg"},l(o(t)("games.mode.delete-confirm")),1)])])])):k("",!0)]))]))}});export{qe as default};
