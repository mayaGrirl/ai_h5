import{d as j,w as q,o as A,q as o,l as e,r as f,J as g,F as m,t as k,z as l,I as C,v as n,x as _}from"./vue-vendor-ntQnFNWs.js";import{a as R}from"./game-Bo-c-YFl.js";import{t as L}from"./index-B8Q_Szy2.js";import"./utils-vendor-CbLx3nH2.js";const z={class:"bg-gray-100 pb-16"},M={class:"bg-white mx-3 my-3 rounded-lg shadow"},D={key:0,class:"flex justify-center items-center py-8"},F={key:1,class:"text-center py-8 text-gray-500"},V={key:2,class:"divide-y"},$={class:"grid grid-cols-[1.2fr_1.5fr_1fr] items-start gap-2"},E={class:"text-sm text-blue-700 font-medium truncate"},G={class:"text-[10px] text-gray-400 mt-1"},J={class:"text-[10px] mt-1"},O={class:"text-center"},H={key:0,class:"text-gray-400"},K={key:1,class:"space-y-1"},P={class:"px-2 py-0.5 bg-blue-100 text-blue-700 rounded"},Q={class:"text-gray-500"},T={key:2,class:"text-gray-400 text-xs text-center"},U={class:"text-center"},W={class:"text-blue-600 font-medium"},X={key:0,class:"mt-2 pt-2 border-t border-dashed flex justify-between items-center text-xs"},Y={class:"text-gray-500"},Z={key:0,class:"py-4 text-center"},tt=["disabled"],et={key:1,class:"py-4 text-center text-gray-400 text-sm"},N=15,lt=j({__name:"record",setup(st){const x=C(),d=f([]),i=f(!1),b=f(1),y=f(!0),B=()=>Number(x.query.lottery_id)||0,I=()=>Number(x.query.group_id)||0,v=async(a=1,s=!1)=>{const t=B(),c=I();if(t)try{i.value=!0;const r=await R({lottery_id:t,game_group_id:c,page:a,pageSize:N});if(r.code===200&&r.data){const u=r.data.list||[];s?d.value=u:d.value=[...d.value,...u],y.value=u.length>=N,b.value=a}else L.error(r.message||"获取投注记录失败"),s&&(d.value=[])}catch{L.error("获取投注记录失败，请稍后重试"),s&&(d.value=[])}finally{i.value=!1}},S=()=>{i.value||!y.value||v(b.value+1,!1)},h=a=>{if(!Array.isArray(a)||a.length===0)return[];const s=a.filter(r=>(r.win_gold||0)>0),t=a.filter(r=>(r.win_gold||0)<=0),c=[];for(const r of s)c.length<3&&c.push(r);for(const r of t)c.length<3&&c.push(r);return c},p=a=>{const s=a.bet_no;return s?Array.isArray(s)?s:typeof s=="object"?Object.values(s):[]:[]},w=a=>{switch(Number(a.status)){case 0:return{text:"未结算",color:"text-orange-600 bg-orange-50"};case 1:return a.is_win===2?{text:"已中奖",color:"text-red-600 bg-red-50"}:{text:"未中奖",color:"text-gray-600 bg-gray-100"};case 2:return{text:"已回滚",color:"text-yellow-600 bg-yellow-50"};case 3:return{text:"已删除",color:"text-gray-400 bg-gray-100"};default:return{text:"--",color:"text-gray-500"}}};return q(()=>[x.query.lottery_id,x.query.group_id],()=>{v(1,!0)}),A(()=>{v(1,!0)}),(a,s)=>(n(),o("div",z,[e("div",M,[s[2]||(s[2]=e("div",{class:"grid grid-cols-[1.2fr_1.5fr_1fr] text-xs text-gray-500 border-b bg-gray-50 px-3 py-2 gap-2 rounded-t-lg"},[e("span",null,"期号/时间"),e("span",{class:"text-center"},"投注详情"),e("span",{class:"text-center"},"金额/状态")],-1)),i.value&&d.value.length===0?(n(),o("div",D,[...s[0]||(s[0]=[e("div",{class:"inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"},null,-1),e("span",{class:"ml-2 text-gray-600"},"加载投注记录中...",-1)])])):d.value.length===0?(n(),o("div",F," 暂无投注记录 ")):(n(),o("div",V,[(n(!0),o(m,null,k(d.value,(t,c)=>(n(),o("div",{key:`${t.id}-${c}`,class:_(["px-3 py-3 text-xs",t.is_win===2?"bg-yellow-50":"bg-white"])},[e("div",$,[e("div",null,[e("div",E,l(t.expect_no||"--"),1),e("div",G,l(t.bet_time||t.created_at||""),1),e("div",J,[s[1]||(s[1]=e("span",{class:"text-gray-500"},"自动：",-1)),e("span",{class:_(t.is_auto===1?"text-green-600":"text-red-500")},l(t.is_auto===1?"√":"×"),3)])]),e("div",O,[h(p(t)).length===0?(n(),o("span",H,"--")):(n(),o("div",K,[(n(!0),o(m,null,k(h(p(t)),(r,u)=>(n(),o("div",{key:u,class:"flex items-center justify-center gap-1 text-xs"},[e("span",P,l(r.bet_no||"--"),1),e("span",Q," x "+l(r.win_gold||0),1)]))),128))])),p(t).length>3?(n(),o("div",T,"......")):g("",!0)]),e("div",U,[e("div",W," 投:"+l((t.bet_gold||0).toLocaleString()),1),t.is_opened===1?(n(),o("div",{key:0,class:_(t.win_gold&&t.win_gold>0?"text-red-600 font-medium":"text-gray-400")}," 中:"+l((t.win_gold||0).toLocaleString()),3)):g("",!0),e("div",{class:_(["inline-block px-2 py-0.5 rounded text-[10px] mt-1",w(t).color])},l(w(t).text),3)])]),t.is_opened===1?(n(),o("div",X,[e("span",Y," 共"+l(t.bet_num||p(t).length)+"注 ",1),e("span",{class:_((t.win_loss||0)>=0?"text-red-600 font-medium":"text-green-600 font-medium")}," 盈亏: "+l((t.win_loss||0)>=0?"+":"")+l((t.win_loss||0).toLocaleString()),3)])):g("",!0)],2))),128)),y.value?(n(),o("div",Z,[e("button",{onClick:S,disabled:i.value,class:"px-6 py-2 bg-red-600 text-white text-sm rounded-lg disabled:opacity-50"},l(i.value?"加载中...":"加载更多"),9,tt)])):g("",!0),!y.value&&d.value.length>0?(n(),o("div",et," 没有更多数据了 ")):g("",!0)]))])]))}});export{lt as default};
