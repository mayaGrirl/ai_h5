import{d as F,o as I,r as L,B as N,q as n,l as t,f as U,u as a,L as h,z as i,K as z,J as m,F as k,t as D,Q as g,R as S,i as b,x as v,c as $,v as d,$ as q}from"./vue-vendor-ntQnFNWs.js";import{_ as C}from"./coin-BjeO1Yvx.js";import{a as E,t as w}from"./index-CFMypmBh.js";import{u as J,t as K,o as O,s as T,n as Q}from"./vee-validate-zod-C4UzdXEl.js";import{B as A,C as G}from"./customer-Dq31nYw8.js";import{_ as H}from"./PageHeader.vue_vue_type_script_setup_true_lang-CAbp2TtD.js";import"./utils-vendor-CbLx3nH2.js";import"./index-C6jzfBHC.js";import"./chevron-left-Cq0BIQK6.js";const P={class:"flex min-h-screen justify-center bg-[#eef3f8]"},W={class:"w-full max-w-xl bg-[#f5f7fb] shadow-sm"},X={class:"grid grid-cols-2 gap-2 px-3 pt-3"},Y={class:"flex justify-center items-center px-3 py-3 bg-white rounded-lg"},Z={class:"flex items-center gap-1 text-red-500 font-semibold"},ee={class:"flex justify-center items-center px-3 py-3 bg-white rounded-lg"},te={class:"flex items-center gap-1 text-red-500 font-semibold"},se={class:"bg-white rounded-lg mb-3 overflow-hidden"},ae={class:"flex items-center px-4 py-3 border-b"},oe=["value"],re={key:0,class:"h-2 w-2 rounded-full bg-white"},le={class:"text-sm"},ne={class:"flex items-center px-4 py-3"},ie={key:0,class:"mt-1 px-4 text-xs text-red-500"},de={class:"flex items-center px-4 py-3 border-t"},pe={key:0,class:"mt-1 px-4 text-xs text-red-500"},ue=["disabled"],he=F({__name:"index",setup(me){const R=N(),{t:V}=E(),p=L(),j=[{value:"in",label:"转入银行"},{value:"out",label:"转出银行"}];I(async()=>{try{const{data:o}=await A();p.value=o}catch(o){console.error("获取资金信息失败",o)}});const B=$(()=>K(O({type:T(),amount:Q({message:"请输入金额"}).int("金额必须为整数").positive("金额必须大于0"),pay_password:T().optional()}).superRefine((o,e)=>{o.type==="out"&&!o.pay_password&&e.addIssue({path:["pay_password"],message:"转出需要输入支付密码",code:"custom"})}).superRefine((o,e)=>{const s=o.type==="out"?p.value?.bankpoints:p.value?.points;s!==void 0&&o.amount>s&&e.addIssue({path:["amount"],message:"金额超出可用余额",code:"custom"})}))),{handleSubmit:M,errors:u,defineField:c,isSubmitting:y}=J({validationSchema:B,initialValues:{type:"in",amount:void 0,pay_password:""}}),[r]=c("type"),[f]=c("amount"),[x]=c("pay_password"),_=M(async o=>{try{const e=await G({type:o.type,amount:o.amount,pay_password:o.pay_password}),{code:s,message:l}=e;s!==200?w.error(l):(w.success(l),R.back())}catch{w.error("操作失败，请稍后重试")}});return(o,e)=>(d(),n("div",P,[t("div",W,[U(H,{title:a(V)("mine.setting.landmark")},null,8,["title"]),t("div",X,[t("div",Y,[e[6]||(e[6]=t("div",{class:"text-gray-500"},"积分",-1)),t("div",Z,[h(i((p.value?.points??0).toLocaleString())+" ",1),e[5]||(e[5]=t("img",{alt:"coin",class:"inline-block w-[13px] h-[13px]",src:C},null,-1))])]),t("div",ee,[e[8]||(e[8]=t("div",{class:"text-gray-500"},"转入银行",-1)),t("div",te,[h(i((p.value?.bankpoints??0).toLocaleString())+" ",1),e[7]||(e[7]=t("img",{alt:"coin",class:"inline-block w-[13px] h-[13px]",src:C},null,-1))])])]),t("form",{onSubmit:e[4]||(e[4]=z((...s)=>a(_)&&a(_)(...s),["prevent"])),class:"w-full bg-gray-100 px-3 py-4"},[t("div",se,[t("div",ae,[e[9]||(e[9]=t("label",{class:"w-2/7 text-gray-700"},"类型",-1)),(d(),n(k,null,D(j,s=>t("label",{key:s.value,class:v(["flex items-center gap-3 px-4 py-3 cursor-pointer",a(r)===s.value?"text-blue-600":"text-gray-700"])},[g(t("input",{type:"radio",value:s.value,"onUpdate:modelValue":e[0]||(e[0]=l=>b(r)?r.value=l:null),class:"hidden"},null,8,oe),[[q,a(r)]]),t("span",{class:v(["flex h-4 w-4 items-center justify-center rounded-full border",a(r)===s.value?"border-red-600 bg-red-600":"border-gray-300"])},[a(r)===s.value?(d(),n("span",re)):m("",!0)],2),t("span",le,i(s.label),1)],2)),64))]),t("div",ne,[e[10]||(e[10]=t("label",{class:"w-2/7 text-gray-700"},"金额",-1)),g(t("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=s=>b(f)?f.value=s:null),placeholder:"请输入金额",class:"text-gray-600 w-5/7 placeholder-gray-400 focus:outline-none h-10",onInput:e[2]||(e[2]=s=>{const l=s.target;l.value=l.value.replace(/[^\d]/g,"")})},null,544),[[S,a(f),void 0,{number:!0}]])]),a(u).amount?(d(),n("p",ie,i(a(u).amount),1)):m("",!0),a(r)==="out"?(d(),n(k,{key:1},[t("div",de,[e[11]||(e[11]=t("label",{class:"w-2/7 text-gray-700"},"支付密码",-1)),g(t("input",{type:"password","onUpdate:modelValue":e[3]||(e[3]=s=>b(x)?x.value=s:null),placeholder:"请输入支付密码",class:"text-gray-600 w-5/7 placeholder-gray-400 focus:outline-none h-10"},null,512),[[S,a(x)]])]),a(u).pay_password?(d(),n("p",pe,i(a(u).pay_password),1)):m("",!0)],64)):m("",!0)]),t("button",{type:"submit",disabled:a(y),class:v(["mt-10 h-12 w-full rounded-full bg-gradient-to-r from-[#ff6a3a] to-[#ff1020] text-white font-medium tracking-wide transition transform active:scale-95",a(y)?"opacity-60 cursor-not-allowed":"cursor-pointer"])},i(a(y)?"提交中...":"确认提交"),11,ue)],32),e[12]||(e[12]=t("div",{class:"h-14"},null,-1))])]))}});export{he as default};
