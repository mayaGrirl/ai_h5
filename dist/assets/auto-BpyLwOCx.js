import{d as A,w as B,o as D,q as a,l as t,k as R,J as C,Q as I,R as N,r as i,f as U,z as u,u as E,x as q,K as F,F as T,t as J,p as K,I as O,v as r}from"./vue-vendor-ntQnFNWs.js";import{d as Q,m as H,e as P}from"./game-CV6KYeLZ.js";import{t as d}from"./index-DWbiG9GH.js";import{C as W}from"./chevron-right-BA-8Nkp-.js";import"./utils-vendor-CbLx3nH2.js";const X={class:"bg-gray-100 pb-32"},Y={class:"space-y-3 mt-3"},Z={class:"bg-white mx-3 rounded-lg shadow"},ee={class:"flex justify-between items-center px-4 py-3 border-b"},te={class:"flex items-center gap-2"},se={class:"flex justify-between items-center px-4 py-3 border-b"},oe={class:"flex justify-between items-center px-4 py-3 border-b"},le={class:"flex items-center gap-2 text-gray-500"},re={key:0,class:"text-red-600 font-medium"},ae={key:1,class:"text-gray-400"},ne={key:0,class:"bg-white mx-3 rounded-lg shadow px-4 py-3"},ie={class:"flex justify-between items-center"},de={class:"fixed bottom-14 left-0 right-0 bg-white p-4 border-t shadow-lg"},ue={class:"flex gap-3"},ce=["disabled"],ve=["disabled"],pe={class:"mx-4 w-full max-w-sm rounded-lg bg-white flex flex-col max-h-[70vh]"},me={class:"flex-1 overflow-y-auto"},ge={key:0,class:"text-center py-8 text-gray-500"},xe={key:1,class:"divide-y"},ye=["onClick"],fe={class:"flex items-center gap-5 font-medium"},be={class:"text-xs text-gray-500 mt-1"},_e={class:"text-xs text-gray-500 mt-1"},we={key:0,class:"text-red-600 text-sm"},he={class:"p-3 border-t"},je=A({__name:"auto",setup(ke){const _=O(),v=i([]),g=i(!1),x=i("1"),y=i(""),f=i(""),n=i(null),p=i(0),w=i(null),S=i(!1),m=i(!1),h=()=>Number(_.query.lottery_id)||0,M=()=>Number(_.query.group_id)||0,z=async()=>{const l=h(),e=M();if(!l)return[];try{const s=await H({lottery_id:l,game_group_id:e,page:1,pageSize:100});if(s.code===200&&s.data){const o=s.data.list||[];return v.value=o,o}else return v.value=[],[]}catch(s){return console.error("获取模式列表失败",s),v.value=[],[]}},j=async l=>{const e=h();if(e)try{S.value=!0;const s=await P({lottery_id:e});if(s.code===200&&s.data&&s.data.id){const o=s.data;w.value=o,x.value=String(o.total_expect_nums||1),y.value=String(o.min_gold||""),f.value=String(o.max_gold||""),p.value=o.status||0;const b=o.mode_id||o.auto_id;if(b){const c=(l||v.value).find(L=>L.id===b);c&&(n.value=c)}}else w.value=null,x.value="1",y.value="",f.value="",n.value=null,p.value=0}catch(s){console.error("获取自动配置失败",s)}finally{S.value=!1}},G=l=>{n.value=l,g.value=!1},V=async l=>{const e=h(),s=M();if(!e){d.error("请选择游戏");return}if(!s){d.error("请选择玩法分组");return}if(!n.value){d.error("请选择投注模式");return}const o=parseInt(x.value,10);if(isNaN(o)||o<1){d.error("执行期数必须大于等于1");return}if(o>1440){d.error("执行期数最大不能超过1440期");return}const b=parseInt(y.value,10)||0,k=parseInt(f.value,10)||0;if(b<0||k<0){d.error("金币数值不能为负数");return}try{m.value=!0;const c=await Q({lottery_id:e,game_group_id:s,mode_id:n.value.id,total_expect_nums:o,min_gold:b,max_gold:k,status:l});c.code===200?(d.success(l===1?"自动投注已启动":"自动投注已关闭"),p.value=l,await j()):d.error(c.message||"操作失败")}catch(c){console.error("操作失败",c),d.error("操作失败，请稍后重试")}finally{m.value=!1}},$=async()=>{const l=await z();await j(l)};return B(()=>[_.query.lottery_id,_.query.group_id],()=>{$()}),D(()=>{$()}),(l,e)=>(r(),a("div",X,[t("div",Y,[t("div",Z,[e[13]||(e[13]=t("div",{class:"px-4 py-3 text-gray-500 text-sm font-medium border-b"},"基础设置",-1)),t("div",ee,[e[9]||(e[9]=t("span",{class:"text-sm"},"执行期数",-1)),t("div",te,[I(t("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=s=>x.value=s),placeholder:"1-1440",min:"1",max:"1440",class:"w-24 px-3 py-2 text-sm border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-red-500"},null,512),[[N,x.value]]),e[8]||(e[8]=t("span",{class:"text-gray-500 text-sm"},"期",-1))])]),t("div",se,[e[10]||(e[10]=t("span",{class:"text-sm"},"金币下限",-1)),I(t("input",{type:"number","onUpdate:modelValue":e[1]||(e[1]=s=>y.value=s),placeholder:"金币≤该值时停止",class:"w-40 px-3 py-2 text-sm border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-red-500"},null,512),[[N,y.value]])]),t("div",oe,[e[11]||(e[11]=t("span",{class:"text-sm"},"金币上限",-1)),I(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=s=>f.value=s),placeholder:"金币≥该值时停止",class:"w-40 px-3 py-2 text-sm border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-red-500"},null,512),[[N,f.value]])]),t("div",{class:"flex justify-between items-center px-4 py-3 cursor-pointer hover:bg-gray-50",onClick:e[3]||(e[3]=s=>g.value=!0)},[e[12]||(e[12]=t("span",{class:"text-sm"},"投注模式",-1)),t("div",le,[n.value?(r(),a("span",re,u(n.value.mode_name),1)):(r(),a("span",ae,"点击选择投注模式")),U(E(W),{size:16})])])]),w.value?(r(),a("div",ne,[t("div",ie,[e[14]||(e[14]=t("span",{class:"text-sm"},"当前状态",-1)),t("span",{class:q(["px-3 py-1 rounded-full text-xs font-medium",p.value===1?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"])},u(p.value===1?"运行中":"已关闭"),3)])])):C("",!0),e[15]||(e[15]=t("div",{class:"mx-3 p-3 bg-yellow-50 rounded-lg border border-yellow-200"},[t("div",{class:"text-center text-gray-500 text-sm mb-2"},"—— 自动投注设置 ——"),t("div",{class:"text-xs text-gray-600 leading-relaxed space-y-1"},[t("p",null,"1、设置自动投注期数（1-1440期）"),t("p",null,"2、设置账户金币上限和下限"),t("p",null,"3、选择自动投注使用的模式"),t("p",null,"4、系统将在指定期数内自动投注"),t("p",null,"5、开启后对号和追号模式将自动关闭")])],-1))]),t("div",de,[t("div",ue,[p.value===1?(r(),a("button",{key:0,onClick:e[4]||(e[4]=s=>V(0)),disabled:m.value,class:"flex-1 h-12 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50"},u(m.value?"处理中...":"关闭托管"),9,ce)):(r(),a("button",{key:1,onClick:e[5]||(e[5]=s=>V(1)),disabled:m.value||!n.value,class:"flex-1 h-12 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50"},u(m.value?"处理中...":"启动托管"),9,ve))])]),(r(),R(K,{to:"body"},[g.value?(r(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:e[7]||(e[7]=F(s=>g.value=!1,["self"]))},[t("div",pe,[e[17]||(e[17]=t("div",{class:"p-3 border-b font-medium"},"选择投注模式",-1)),t("div",me,[v.value.length===0?(r(),a("div",ge,[...e[16]||(e[16]=[t("p",null,"暂无模式",-1),t("p",{class:"text-sm mt-2"},'请先在"模式"页面创建投注模式',-1)])])):(r(),a("div",xe,[(r(!0),a(T,null,J(v.value,s=>(r(),a("button",{key:s.id,onClick:o=>G(s),class:q(["w-full px-4 py-3 text-left hover:bg-gray-50 flex justify-between items-center",n.value?.id===s.id&&"bg-red-50"])},[t("div",null,[t("div",fe,[t("span",null,u(s.mode_name),1),t("span",null,u(s.bet_gold),1)]),t("div",be,"玩法: "+u(s.bet_no),1),t("div",_e,"金豆: "+u(s.bet_no_gold),1)]),n.value?.id===s.id?(r(),a("span",we,"已选")):C("",!0)],10,ye))),128))]))]),t("div",he,[t("button",{onClick:e[6]||(e[6]=s=>g.value=!1),class:"w-full py-2 bg-gray-200 text-gray-700 rounded-lg"}," 关闭 ")])])])):C("",!0)]))]))}});export{je as default};
