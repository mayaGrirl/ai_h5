import{d as w,o as k,r as a,b as C,q as o,n as e,C as p,f as M,y as g,F as D,t as B,x as n,D as R,l as i}from"./vue-vendor-2ZNhN7Rr.js";import{a as Y}from"./agent-Bo7i0TLD.js";import{t as y}from"./index-BC9sSM5C.js";import{d as j}from"./dayjs.min-CLb2-34J.js";import{C as F}from"./chevron-left-Cd9iVQbM.js";import"./utils-vendor-CbLx3nH2.js";const L={class:"flex min-h-screen justify-center bg-[#eef3f8]"},V={class:"w-full max-w-xl bg-[#f5f7fb] shadow-sm"},z={class:"sticky top-0 z-40 bg-gradient-to-r from-red-600 to-red-500"},I={class:"flex h-12 items-center justify-between px-3"},N={class:"text-center font-medium"},P={class:"text-center font-medium"},q={class:"text-red-600"},E={class:"text-center font-medium"},O={key:1,class:"py-4 text-center text-xs text-gray-400"},J=w({__name:"index",setup(S){const _=R(),l=a([]),x=a(1),c=a(!0),d=a(!1),u=a(null);let f=null;const m=async r=>{d.value=!0;try{const{code:t,data:s,message:v}=await Y({search:{type:4},pagination:{page:r,size:20}});await new Promise(b=>setTimeout(b,553)),t===200?(s.length<20&&(c.value=!1),r===1&&(l.value=[]),l.value=[...l.value,...s]):y.error(v)}catch{y.error("获取数据失败")}finally{d.value=!1}};k(async()=>{await m(1),u.value&&c.value&&(f=new IntersectionObserver(([r])=>{if(r.isIntersecting&&!d.value){const t=x.value+1;x.value=t,m(t)}},{threshold:1}),f.observe(u.value))}),C(()=>{f&&f.disconnect()});const h=()=>{_.back()};return(r,t)=>(i(),o("div",L,[e("div",V,[e("header",z,[e("div",I,[e("button",{onClick:h,class:"flex items-center text-white"},[M(g(F),{class:"h-5 w-5"})]),t[0]||(t[0]=e("span",{class:"text-white font-bold"},"回收记录",-1)),t[1]||(t[1]=e("div",{class:"w-5"},null,-1))])]),t[2]||(t[2]=e("div",{class:"grid grid-cols-[0.4fr_0.5fr_1fr] px-1 py-1 text-xs text-gray-500 border-b bg-white"},[e("div",{class:"text-center"},"日期"),e("div",{class:"text-center"},"积分"),e("div",{class:"text-center"},"备注")],-1)),(i(!0),o(D,null,B(l.value,(s,v)=>(i(),o("div",{key:`all-key-${v}`,class:"grid grid-cols-[0.4fr_0.5fr_1fr] px-1 py-1 border-b text-sm items-center bg-white"},[e("div",N,n(g(j).unix(s?.addtime||0).format("YYYY-MM-DD")),1),e("div",P,[e("div",q,n(s.points),1),e("div",null,n(((s?.points||0)/1e3).toFixed(0))+"元",1)]),e("div",E,n(s.content),1)]))),128)),c.value?(i(),o("div",{key:0,ref_key:"loadMoreRef",ref:u,class:"py-4 text-center text-xs text-gray-400"},n(d.value?"加载中...":"上拉加载更多"),513)):p("",!0),c.value?p("",!0):(i(),o("div",O," 没有更多数据了 ")),t[3]||(t[3]=e("div",{class:"h-14"},null,-1))])]))}});export{J as default};
