import{a as w}from"./index-jbolejyT.js";import{s as k}from"./home-BOPNk9Cb.js";import{_ as M}from"./PageHeader.vue_vue_type_script_setup_true_lang-B34oY6br.js";import{d as V,o as j,b as B,q as s,l as o,f as I,J as p,u as v,r as d,F as y,t as h,z as f,v as a,O as L}from"./vue-vendor-ntQnFNWs.js";import"./utils-vendor-CbLx3nH2.js";import"./index-C6jzfBHC.js";import"./chevron-left-Bkn4bUZu.js";const O={class:"flex min-h-screen justify-center bg-[#eef3f8]"},T={class:"w-full max-w-xl bg-[#f5f7fb] shadow-sm"},q={key:0,class:"flex flex-col gap-2 px-3 mt-2"},z={key:1,class:"text-center py-16 text-gray-500"},C={key:2,class:"flex flex-col gap-2 px-3 mt-2"},D={class:"flex justify-between items-start mb-2"},F={class:"font-bold text-base text-gray-900"},H={class:"text-xs text-gray-400 whitespace-nowrap ml-2"},N=["innerHTML"],R={key:4,class:"py-4 text-center text-xs text-gray-400"},P=V({__name:"index",setup(S){const{t:c}=w(),l=d([]),x=d(1),i=d(!0),n=d(!1),m=d(null);let u=null;const g=async r=>{if(!n.value){n.value=!0;try{const e=await k({pagination:{page:r,size:20}});if(e.code===200){const t=e.data||[];t.length<20&&(i.value=!1),r===1?l.value=t:l.value=[...l.value,...t],x.value=r}}catch(e){console.error("加载站内消息失败",e)}finally{n.value=!1}}},_=()=>{!m.value||!i.value||(u=new IntersectionObserver(([r])=>{r.isIntersecting&&!n.value&&i.value&&g(x.value+1)},{threshold:1}),u.observe(m.value))};return j(()=>{g(1),setTimeout(_,100)}),B(()=>{u&&u.disconnect()}),(r,e)=>(a(),s("div",O,[o("div",T,[I(M,{title:v(c)("mine.quick.mail")},null,8,["title"]),n.value&&l.value.length===0?(a(),s("div",q,[(a(),s(y,null,h(5,t=>o("div",{key:t,class:"bg-white rounded-xl border py-3 px-3 shadow-sm"},[...e[0]||(e[0]=[L('<div class="flex justify-between mb-2"><div class="h-5 w-32 bg-gray-200 rounded animate-pulse"></div><div class="h-4 w-24 bg-gray-200 rounded animate-pulse"></div></div><div class="h-4 w-full bg-gray-200 rounded animate-pulse mb-1"></div><div class="h-4 w-3/4 bg-gray-200 rounded animate-pulse"></div>',3)])])),64))])):!n.value&&l.value.length===0?(a(),s("div",z," 暂无消息 ")):(a(),s("div",C,[(a(!0),s(y,null,h(l.value,(t,b)=>(a(),s("div",{key:b,class:"bg-white rounded-xl border py-3 px-3 shadow-sm"},[o("div",D,[o("div",F,f(t?.title),1),o("div",H,f(t?.created_at),1)]),o("div",{class:"text-sm text-gray-600 leading-relaxed",innerHTML:t?.content},null,8,N)]))),128))])),i.value?(a(),s("div",{key:3,ref_key:"loadMoreRef",ref:m,class:"py-4 text-center text-xs text-gray-400"},f(n.value?v(c)("common.loading"):v(c)("common.loading-hit")),513)):p("",!0),!i.value&&l.value.length>0?(a(),s("div",R,f(v(c)("common.loading-list-empty")),1)):p("",!0),e[1]||(e[1]=o("div",{class:"h-14"},null,-1))])]))}});export{P as default};
