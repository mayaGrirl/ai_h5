import{d as _e,o as he,q as u,J as K,l as n,r as k,F as f,t as h,L as O,k as Z,z as v,u as x,Q as ye,R as ke,c as A,x as b,B as we,I as Ce,v as d}from"./vue-vendor-ntQnFNWs.js";import{_ as Se}from"./coin-BjeO1Yvx.js";import{c as _}from"./index-C6jzfBHC.js";import{g as Ee,p as Ie,m as Be,s as Ne}from"./game-qbYhjhVu.js";import{t as S}from"./index-CFMypmBh.js";import{C as Me}from"./chevron-up-CiN60YSQ.js";import{C as $e}from"./chevron-down-CIXRLCML.js";import"./utils-vendor-CbLx3nH2.js";const Ge={class:"bg-gray-100 pb-32"},Ae={key:0,class:"bg-white mx-3 mt-3 rounded-lg shadow p-3"},je={class:"grid grid-cols-6 gap-2 mb-2"},qe=["onClick"],Pe={class:"grid grid-cols-6 gap-2 mb-2"},Ve=["onClick"],Le={class:"grid grid-cols-6 gap-2"},ze=["onClick"],De=["onClick"],Qe={key:1,class:"grid grid-cols-4 gap-2"},We=["onClick"],Fe={key:0,class:"mt-4 grid grid-cols-2 gap-3"},Re={class:"grid grid-cols-4 gap-1"},Te=["onClick"],Ue={class:"grid grid-cols-4 gap-1 mt-1"},Je=["onClick"],He={class:"grid grid-cols-4 gap-1 mt-1"},Ke=["onClick"],Oe={class:"grid grid-cols-3 gap-1"},Xe=["onClick"],Ye={class:"grid grid-cols-4 gap-1 mt-1"},Ze=["onClick"],et={class:"grid grid-cols-5 gap-1 mt-1"},tt=["onClick"],st={class:"mt-4"},rt={class:"grid grid-cols-6 gap-2"},nt=["onClick"],at={class:"grid grid-cols-6 gap-2 mt-2"},lt=["onClick"],ot={class:"bg-white mx-3 mt-3 mb-[20px] rounded-lg shadow"},it={key:0,class:"flex justify-center items-center py-8"},dt={key:1,class:"divide-y"},ut={class:"flex flex-col items-start"},ct=["onClick"],mt={class:"text-center text-sm text-gray-600"},gt={class:"flex justify-center"},pt=["value","onInput"],vt={class:"flex items-center justify-end gap-1"},xt=["onClick"],ft=["onClick"],bt=["onClick"],_t={key:2,class:"text-center py-8 text-gray-500"},ht={class:"fixed bottom-14 left-0 right-0 bg-white border-t shadow-lg"},yt={class:"flex items-center justify-between px-4 py-2 border-b"},kt={class:"flex items-center text-sm flex-shrink-0"},wt={class:"text-red-600 font-bold ml-1"},Ct={class:"grid grid-cols-2 h-12"},St=["disabled"],qt=_e({__name:"edit",setup(Et){const L=Ce(),z=we(),I=A(()=>L.query.lottery_id||""),j=A(()=>L.query.group_id||""),B=A(()=>L.query.mode_id||""),q=A(()=>!!B.value&&B.value!=="0"),ee=k("加载中..."),P=k(""),M=k(""),te=k([]),D=k(!0),Q=k(!1),V=k(!1),X=[1,2,3,10,14,18,22,4,26,5,16,23,6,15,24],se=["全包","单","大单","小单","单边","双"],re=["大双","小双","双边","大","小","中"],ne=["边","大边","小边"],ae=["反选","清空"],W=["0尾","1尾","2尾","3尾","4尾","5尾","6尾","7尾","8尾","9尾","小尾","大尾"],le=["3余0","3余1","3余2"],oe=["4余0","4余1","4余2","4余3"],ie=["5余0","5余1","5余2","5余3","5余4"],de=[.1,.5,.8,1.2,1.5,2],ue=[5,10,20,30,50,100],p=k(null),c=k([]),g=k({}),y=k(null),$=k(!1),F=k(null),ce=async()=>{if(I.value)try{const l=await Ee({});if(l.code===200&&l.data){const{gameTypeMap:a=[]}=l.data;for(const e of a){const o=e.children?.find(m=>String(m.id)===String(I.value));if(o){ee.value=o.name;return}}}}catch(l){console.error("获取游戏名称失败",l)}},me=async()=>{if(!I.value){z.push("/games");return}try{D.value=!0;const l=await Ie({lottery_id:parseInt(I.value)});if(l.code===200&&l.data){const{gamePlayMap:a=[],groupArr:e=[]}=l.data,o={};e.forEach(r=>{o[r.id]={betMultiplier:r.bet_multiplier||"",startNum:r.start_num||0}});const m=a.map(r=>{const i=o[r.id]||{betMultiplier:"",startNum:0};return{id:r.id,name:r.name,betMultiplier:i.betMultiplier,startNum:i.startNum,plays:(r.children||[]).map(C=>({id:C.id,name:C.name,odds:C.multiple||0,minBetGold:C.min_bet_gold||0}))}}).filter(r=>r.plays.length>0);if(te.value=m,q.value&&B.value)await ge(m);else if(j.value&&m.length>0){const r=m.find(i=>String(i.id)===String(j.value));r?(p.value=r,P.value=r.name):(p.value=m[0],P.value=m[0].name)}else m.length>0&&(p.value=m[0],P.value=m[0].name)}}catch(l){console.error("获取玩法列表失败",l),S.error("获取玩法列表失败，请稍后重试")}finally{D.value=!1}},ge=async l=>{if(!(!q.value||!I.value||!j.value||!B.value))try{Q.value=!0;const a=await Be({lottery_id:parseInt(I.value),game_group_id:parseInt(j.value),mode_id:parseInt(B.value),page:1,pageSize:100});if(a.code===200&&a.data){const e=a.data.list||[],o=e.find(m=>String(m.id)===String(B.value))||e[0];if(o){const m=l.find(E=>Number(E.id)===o.game_group_id),i=(o.bet_no||"").split(",").filter(E=>E.trim()!==""),G=(o?.bet_no_gold||"").split(","),s=(o.lottery_played_id||"").split(",").filter(E=>E.trim()!=="");let N=[];const U={};m&&s.length>0&&s.forEach((E,J)=>{const H=m.plays.find(be=>String(be.id)===String(E));H&&(N.push(H.name),U[H.name]=G[J]||"0")}),N.length===0&&i.length>0&&(N=i,i.forEach((E,J)=>{U[E]=G[J]||"0"})),M.value=o.mode_name||"",c.value=[...N],g.value={...U},m&&(p.value=m,P.value=m.name)}}}catch(a){console.error("加载模式数据失败",a),S.error("加载模式数据失败")}finally{Q.value=!1}};he(()=>{ce(),me()});const pe=l=>{const a=l.name;if(c.value.includes(a)){c.value=c.value.filter(o=>o!==a);const e={...g.value};delete e[a],g.value=e}else{const e=l.minBetGold||0;e>0&&(g.value={...g.value,[a]:String(e)}),c.value=[...c.value,a]}},ve=(l,a)=>{g.value={...g.value,[l]:a}},w=l=>{if(!p.value)return;const a=Number(p.value.id),e=p.value.plays.filter(t=>!isNaN(parseInt(t.name,10))).sort((t,s)=>parseInt(t.name,10)-parseInt(s.name,10));if(["全包","单","双","大单","小单","大双","小双","单边","双边","大","小","中","边","大边","小边","0尾","1尾","2尾","3尾","4尾","5尾","6尾","7尾","8尾","9尾","小尾","大尾","3余0","3余1","3余2","4余0","4余1","4余2","4余3","5余0","5余1","5余2","5余3","5余4"].includes(l)&&y.value===l){c.value=[],g.value={},y.value=null;return}const r=(t=>[1,2,3,10,14,18,22].includes(t)?{min:0,max:27,bigStart:14,smallEnd:13,midStart:10,midEnd:17,bigEdgeStart:18,smallEdgeEnd:9}:[6,15,24].includes(t)?{min:3,max:18,bigStart:11,smallEnd:10,midStart:8,midEnd:13,bigEdgeStart:14,smallEdgeEnd:7}:[5,16,23].includes(t)?{min:2,max:12,bigStart:7,smallEnd:6,midStart:5,midEnd:9,bigEdgeStart:10,smallEdgeEnd:4}:[4,26].includes(t)?{min:1,max:10,bigStart:6,smallEnd:5,midStart:4,midEnd:7,bigEdgeStart:8,smallEdgeEnd:3}:null)(a);let i=[],C=l;switch(l){case"清空":c.value=[],g.value={},y.value=null;return;case"反选":i=p.value.plays.filter(t=>!c.value.includes(t.name)).map(t=>t.name),C=null;break;case"全包":i=p.value.plays.map(t=>t.name);break;case"单":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.min&&s<=r.max&&s%2===1}).map(t=>t.name));break;case"双":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.min&&s<=r.max&&s%2===0}).map(t=>t.name));break;case"大单":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.bigStart&&s<=r.max&&s%2===1}).map(t=>t.name));break;case"小单":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.min&&s<=r.smallEnd&&s%2===1}).map(t=>t.name));break;case"大双":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.bigStart&&s<=r.max&&s%2===0}).map(t=>t.name));break;case"小双":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.min&&s<=r.smallEnd&&s%2===0}).map(t=>t.name));break;case"单边":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.min&&s<=r.max&&(s<r.midStart||s>r.midEnd)&&s%2===1}).map(t=>t.name));break;case"双边":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.min&&s<=r.max&&(s<r.midStart||s>r.midEnd)&&s%2===0}).map(t=>t.name));break;case"大":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.bigStart&&s<=r.max}).map(t=>t.name));break;case"小":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.min&&s<=r.smallEnd}).map(t=>t.name));break;case"中":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.midStart&&s<=r.midEnd}).map(t=>t.name));break;case"边":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.min&&s<=r.max&&(s<r.midStart||s>r.midEnd)}).map(t=>t.name));break;case"大边":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.bigEdgeStart&&s<=r.max}).map(t=>t.name));break;case"小边":r&&(i=e.filter(t=>{const s=parseInt(t.name,10);return s>=r.min&&s<=r.smallEdgeEnd}).map(t=>t.name));break;default:if(l.endsWith("尾"))if(l==="小尾")i=e.filter(t=>parseInt(t.name,10)%10<=4).map(t=>t.name);else if(l==="大尾")i=e.filter(t=>parseInt(t.name,10)%10>=5).map(t=>t.name);else{const t=parseInt(l.replace("尾",""),10);i=e.filter(s=>parseInt(s.name,10)%10===t).map(s=>s.name)}else if(l.startsWith("3余")){const t=parseInt(l.replace("3余",""),10);i=e.filter(s=>parseInt(s.name,10)%3===t).map(s=>s.name)}else if(l.startsWith("4余")){const t=parseInt(l.replace("4余",""),10);i=e.filter(s=>parseInt(s.name,10)%4===t).map(s=>s.name)}else if(l.startsWith("5余")){const t=parseInt(l.replace("5余",""),10);i=e.filter(s=>parseInt(s.name,10)%5===t).map(s=>s.name)}}const G={};i.forEach(t=>{const s=p.value?.plays.find(N=>N.name===t);s&&s.minBetGold>0&&(G[t]=String(s.minBetGold))}),g.value=G,c.value=i,y.value=C},Y=l=>{if(F.value=l,c.value.length===0){S.info("请先选择玩法");return}const a={...g.value};c.value.forEach(e=>{const o=parseInt(a[e]||"0",10)||0;o>0&&(a[e]=String(Math.floor(o*l)))}),g.value=a},R=(l,a)=>{const e=parseInt(g.value[l]||"0",10)||0;e>0&&(g.value={...g.value,[l]:String(Math.floor(e*a))})},xe=()=>{z.back()},fe=async()=>{if(!p.value){S.error("请选择玩法分组");return}if(!M.value.trim()){S.error("请输入模式名称");return}if(c.value.length===0){S.error("请选择至少一个玩法");return}const l=c.value.join(","),a=c.value.map(r=>g.value[r]||"0").join(","),e=c.value.map(r=>{const i=p.value?.plays.find(C=>C.name===r);return i?i.id:""}).filter(r=>r!=="").join(","),o=c.value.reduce((r,i)=>r+(parseInt(g.value[i]||"0",10)||0),0);if(o<=0){S.error("请输入投注金额");return}const m={lottery_id:I.value,game_group_id:p.value.id,lottery_played_id:e,bet_no:l,bet_gold:a,total_gold:o,mode_name:M.value.trim(),mode_id:q.value?parseInt(B.value):0,status:1};try{V.value=!0;const r=await Ne(m);r.code===200?(S.success(q.value?"模式更新成功":"模式保存成功"),z.back()):S.error(r.message||"保存失败")}catch(r){console.error("保存模式失败：",r),S.error("保存失败，请稍后重试")}finally{V.value=!1}},T=A(()=>c.value.reduce((l,a)=>l+(parseInt(g.value[a]||"0",10)||0),0));return(l,a)=>(d(),u("div",Ge,[p.value?(d(),u("div",Ae,[X.includes(Number(p.value.id))?(d(),u(f,{key:0},[n("div",je,[(d(),u(f,null,h(se,e=>n("button",{key:e,onClick:o=>w(e),class:b(x(_)("py-1.5 text-xs rounded border",y.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300 hover:border-red-500"))},v(e),11,qe)),64))]),n("div",Pe,[(d(),u(f,null,h(re,e=>n("button",{key:e,onClick:o=>w(e),class:b(x(_)("py-1.5 text-xs rounded border",y.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300 hover:border-red-500"))},v(e),11,Ve)),64))]),n("div",Le,[(d(),u(f,null,h(ne,e=>n("button",{key:e,onClick:o=>w(e),class:b(x(_)("py-1.5 text-xs rounded border",y.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300 hover:border-red-500"))},v(e),11,ze)),64)),(d(),u(f,null,h(ae,e=>n("button",{key:e,onClick:o=>w(e),class:"py-1.5 text-xs rounded bg-red-600 text-white"},v(e),9,De)),64))])],64)):(d(),u("div",Qe,[(d(),u(f,null,h(["全包","反选","清空"],e=>n("button",{key:e,onClick:o=>w(e),class:"py-1.5 text-xs rounded bg-red-600 text-white"},v(e),9,We)),64))])),$.value?(d(),u(f,{key:2},[X.includes(Number(p.value.id))?(d(),u("div",Fe,[n("div",null,[a[2]||(a[2]=n("div",{class:"flex items-center mb-2"},[n("span",{class:"text-xs text-gray-500"},"—"),n("span",{class:"text-xs text-gray-600 mx-1"},"追加尾数"),n("span",{class:"text-xs text-gray-500 flex-1"},"———")],-1)),n("div",Re,[(d(!0),u(f,null,h(W.slice(0,4),e=>(d(),u("button",{key:e,onClick:o=>w(e),class:b(x(_)("py-1 text-[10px] rounded border",y.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"))},v(e),11,Te))),128))]),n("div",Ue,[(d(!0),u(f,null,h(W.slice(4,8),e=>(d(),u("button",{key:e,onClick:o=>w(e),class:b(x(_)("py-1 text-[10px] rounded border",y.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"))},v(e),11,Je))),128))]),n("div",He,[(d(!0),u(f,null,h(W.slice(8),e=>(d(),u("button",{key:e,onClick:o=>w(e),class:b(x(_)("py-1 text-[10px] rounded border",y.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"))},v(e),11,Ke))),128))])]),n("div",null,[a[3]||(a[3]=n("div",{class:"flex items-center mb-2"},[n("span",{class:"text-xs text-gray-500"},"—"),n("span",{class:"text-xs text-gray-600 mx-1"},"追加余数"),n("span",{class:"text-xs text-gray-500 flex-1"},"———")],-1)),n("div",Oe,[(d(),u(f,null,h(le,e=>n("button",{key:e,onClick:o=>w(e),class:b(x(_)("py-1 text-[10px] rounded border",y.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"))},v(e),11,Xe)),64))]),n("div",Ye,[(d(),u(f,null,h(oe,e=>n("button",{key:e,onClick:o=>w(e),class:b(x(_)("py-1 text-[10px] rounded border",y.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"))},v(e),11,Ze)),64))]),n("div",et,[(d(),u(f,null,h(ie,e=>n("button",{key:e,onClick:o=>w(e),class:b(x(_)("py-1 text-[10px] rounded border",y.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"))},v(e),11,tt)),64))])])])):K("",!0),n("div",st,[a[4]||(a[4]=n("div",{class:"flex items-center mb-2"},[n("span",{class:"text-xs text-gray-500"},"——"),n("span",{class:"text-xs text-gray-600 mx-2"},"倍数投注"),n("span",{class:"text-xs text-gray-500 flex-1"},"——————————")],-1)),n("div",rt,[(d(),u(f,null,h(de,e=>n("button",{key:e,onClick:o=>Y(e),class:b(x(_)("py-1.5 text-xs rounded border",F.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"))},v(e)+"倍 ",11,nt)),64))]),n("div",at,[(d(),u(f,null,h(ue,e=>n("button",{key:e,onClick:o=>Y(e),class:b(x(_)("py-1.5 text-xs rounded border",F.value===e?"bg-red-600 text-white border-red-600":"bg-white text-gray-700 border-red-300"))},v(e)+"倍 ",11,lt)),64))])])],64)):K("",!0),n("button",{onClick:a[0]||(a[0]=e=>$.value=!$.value),class:"w-full mt-3 py-2 bg-orange-500 text-white rounded-lg flex items-center justify-center gap-1"},[O(v($.value?"收起":"展开")+" ",1),$.value?(d(),Z(x(Me),{key:0,size:16})):(d(),Z(x($e),{key:1,size:16}))])])):K("",!0),n("div",ot,[a[6]||(a[6]=n("div",{class:"grid grid-cols-[80px_1fr_100px_90px] text-xs text-gray-500 border-b px-3 py-2"},[n("span",null,"号码"),n("span",{class:"text-center"},"赔率"),n("span",{class:"text-center"},"投注"),n("span")],-1)),D.value||Q.value?(d(),u("div",it,[...a[5]||(a[5]=[n("div",{class:"inline-block h-6 w-6 animate-spin rounded-full border-4 border-solid border-blue-600 border-r-transparent"},null,-1),n("span",{class:"ml-2 text-gray-600"},"加载中...",-1)])])):p.value?(d(),u("div",dt,[(d(!0),u(f,null,h(p.value.plays,e=>(d(),u("div",{key:e.id,class:b(x(_)("grid grid-cols-[80px_1fr_100px_90px] items-center px-3 py-2",c.value.includes(e.name)?"bg-orange-50":"bg-white"))},[n("div",ut,[n("button",{onClick:o=>pe(e),class:b(x(_)("w-10 h-10 rounded-full flex items-center justify-center text-sm font-bold",c.value.includes(e.name)?"bg-blue-600 text-white":"bg-blue-100 text-blue-700"))},v(e.name),11,ct)]),n("div",mt,v((e.odds/1e3).toFixed(2)),1),n("div",gt,[n("input",{type:"number",value:g.value[e.name]||"",onInput:o=>ve(e.name,o.target.value),placeholder:"0",class:b(x(_)("w-20 h-8 px-2 text-center text-sm border rounded",c.value.includes(e.name)?"border-orange-400 bg-orange-50":"border-gray-300 bg-gray-50"))},null,42,pt)]),n("div",vt,[n("button",{onClick:o=>R(e.name,.5),class:"text-xs text-blue-600"}," ×0.5 ",8,xt),n("button",{onClick:o=>R(e.name,2),class:"text-xs text-blue-600"}," ×2 ",8,ft),n("button",{onClick:o=>R(e.name,10),class:"text-xs text-blue-600"}," ×10 ",8,bt)])],2))),128))])):(d(),u("div",_t,"暂无玩法数据"))]),n("div",ht,[n("div",yt,[ye(n("input",{type:"text","onUpdate:modelValue":a[1]||(a[1]=e=>M.value=e),placeholder:"填写模式名称",class:"flex-1 h-8 px-3 text-sm border border-gray-300 rounded mr-3",maxlength:"20"},null,512),[[ke,M.value]]),n("div",kt,[a[7]||(a[7]=n("span",{class:"text-gray-600"},"总投入",-1)),n("span",wt,v(T.value.toLocaleString()),1),a[8]||(a[8]=n("img",{alt:"coin",class:"inline-block w-4 h-4 ml-0.5",src:Se},null,-1))])]),n("div",Ct,[n("button",{onClick:xe,class:"bg-white text-gray-700 font-bold flex items-center justify-center gap-1 border-r"},[...a[9]||(a[9]=[n("span",{class:"text-lg"},"<",-1),O(" 取消 ",-1)])]),n("button",{onClick:fe,disabled:V.value||c.value.length===0||T.value<=0,class:b(x(_)("font-bold flex items-center justify-center gap-1",V.value||c.value.length===0||T.value<=0?"bg-gray-400 text-gray-200 cursor-not-allowed":"bg-blue-600 text-white"))},[...a[10]||(a[10]=[n("span",{class:"text-lg"},"✓",-1),O(" 保存模式 ",-1)])],10,St)])])]))}});export{qt as default};
