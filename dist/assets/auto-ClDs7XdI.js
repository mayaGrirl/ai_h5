import{d as U,w as D,o as F,q as d,n as e,k as R,C as M,x as a,y as o,S as N,U as S,r as c,f as T,u as z,M as O,F as H,t as J,m as K,L as P,l as i}from"./vue-vendor-2ZNhN7Rr.js";import{a as Q,t as m}from"./index-6bPpM1RI.js";import{d as W,m as X,e as Y}from"./game-Bsoc-G5D.js";import{C as Z}from"./chevron-right-Dzpe0bhI.js";import"./utils-vendor-CbLx3nH2.js";const ee={class:"bg-gray-100 pb-32"},te={class:"space-y-3 mt-3"},se={class:"bg-white mx-3 rounded-lg shadow"},oe={class:"px-4 py-3 text-gray-500 text-sm font-medium border-b"},ae={class:"flex justify-between items-center px-4 py-3 border-b"},ne={class:"text-sm"},le={class:"flex items-center gap-2"},re={class:"text-gray-500 text-sm"},ie={class:"flex justify-between items-center px-4 py-3 border-b"},de={class:"text-sm"},ue=["placeholder"],ce={class:"flex justify-between items-center px-4 py-3 border-b"},me={class:"text-sm"},ge=["placeholder"],pe={class:"text-sm"},ve={class:"flex items-center gap-2 text-gray-500"},_e={key:0,class:"text-red-600 font-medium"},xe={key:1,class:"text-gray-400"},ye={key:0,class:"bg-white mx-3 rounded-lg shadow px-4 py-3"},fe={class:"flex justify-between items-center"},be={class:"text-sm"},he={class:"mx-3 p-3 bg-yellow-50 rounded-lg border border-yellow-200"},we={class:"text-center text-gray-500 text-sm mb-2"},ke={class:"text-xs text-gray-600 leading-relaxed space-y-1"},Ce={class:"fixed bottom-14 left-0 right-0 bg-white p-4 border-t shadow-lg"},Ie={class:"flex gap-3"},Me=["disabled"],Ne=["disabled"],Se={class:"mx-4 w-full max-w-sm rounded-lg bg-white flex flex-col max-h-[70vh]"},je={class:"p-3 border-b font-medium"},qe={class:"flex-1 overflow-y-auto"},Le={key:0,class:"text-center py-8 text-gray-500"},Ve={class:"text-sm mt-2"},$e={key:1,class:"divide-y"},Ge=["onClick"],ze={class:"flex items-center gap-5 font-medium"},Ae={class:"text-xs text-gray-500 mt-1"},Be={class:"text-xs text-gray-500 mt-1"},Ee={key:0,class:"text-red-600 text-sm"},Ue={class:"p-3 border-t"},Je=U({__name:"auto",setup(De){const{t}=Q(),w=P(),p=c([]),x=c(!1),y=c("1"),f=c(""),b=c(""),u=c(null),v=c(0),k=c(null),j=c(!1),_=c(!1),C=()=>Number(w.query.lottery_id)||0,q=()=>Number(w.query.group_id)||0,A=async()=>{const r=C(),n=q();if(!r)return[];try{const s=await X({lottery_id:r,game_group_id:n,page:1,pageSize:100});if(s.code===200&&s.data){const l=s.data.list||[];return p.value=l,l}else return p.value=[],[]}catch(s){return console.error("获取模式列表失败",s),p.value=[],[]}},L=async r=>{const n=C();if(n)try{j.value=!0;const s=await Y({lottery_id:n});if(s.code===200&&s.data&&s.data.id){const l=s.data;k.value=l,y.value=String(l.total_expect_nums||1),f.value=String(l.min_gold||""),b.value=String(l.max_gold||""),v.value=l.status||0;const h=l.mode_id||l.auto_id;if(h){const g=(r||p.value).find(G=>G.id===h);g&&(u.value=g)}}else k.value=null,y.value="1",f.value="",b.value="",u.value=null,v.value=0}catch(s){console.error("获取自动配置失败",s)}finally{j.value=!1}},B=r=>{u.value=r,x.value=!1},V=async r=>{const n=C(),s=q();if(!n){m.error(t("games.auto.select-game"));return}if(!s){m.error(t("games.auto.select-group"));return}if(!u.value){m.error(t("games.auto.select-mode-required"));return}const l=parseInt(y.value,10);if(isNaN(l)||l<1){m.error(t("games.auto.periods-min"));return}if(l>1440){m.error(t("games.auto.periods-max"));return}const h=parseInt(f.value,10)||0,I=parseInt(b.value,10)||0;if(h<0||I<0){m.error(t("games.auto.coins-negative"));return}try{_.value=!0;const g=await W({lottery_id:n,game_group_id:s,mode_id:u.value.id,total_expect_nums:l,min_gold:h,max_gold:I,status:r});g.code===200?(m.success(t(r===1?"games.auto.start-success":"games.auto.stop-success")),v.value=r,await L()):m.error(g.message||t("games.auto.operation-failed"))}catch(g){console.error("操作失败",g);const E=g?.response?.data?.message;m.error(E||t("games.auto.operation-failed-retry"))}finally{_.value=!1}},$=async()=>{const r=await A();await L(r)};return D(()=>[w.query.lottery_id,w.query.group_id],()=>{$()}),F(()=>{$()}),(r,n)=>(i(),d("div",ee,[e("div",te,[e("div",se,[e("div",oe,a(o(t)("games.auto.basic-settings")),1),e("div",ae,[e("span",ne,a(o(t)("games.auto.periods")),1),e("div",le,[N(e("input",{type:"number","onUpdate:modelValue":n[0]||(n[0]=s=>y.value=s),placeholder:"1-1440",min:"1",max:"1440",class:"w-24 px-3 py-2 text-sm border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-red-500"},null,512),[[S,y.value]]),e("span",re,a(o(t)("games.auto.period-unit")),1)])]),e("div",ie,[e("span",de,a(o(t)("games.auto.min-coins")),1),N(e("input",{type:"number","onUpdate:modelValue":n[1]||(n[1]=s=>f.value=s),placeholder:o(t)("games.auto.min-coins-hint"),class:"w-40 px-3 py-2 text-sm border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-red-500"},null,8,ue),[[S,f.value]])]),e("div",ce,[e("span",me,a(o(t)("games.auto.max-coins")),1),N(e("input",{type:"number","onUpdate:modelValue":n[2]||(n[2]=s=>b.value=s),placeholder:o(t)("games.auto.max-coins-hint"),class:"w-40 px-3 py-2 text-sm border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-red-500"},null,8,ge),[[S,b.value]])]),e("div",{class:"flex justify-between items-center px-4 py-3 cursor-pointer hover:bg-gray-50",onClick:n[3]||(n[3]=s=>x.value=!0)},[e("span",pe,a(o(t)("games.auto.bet-mode")),1),e("div",ve,[u.value?(i(),d("span",_e,a(u.value.mode_name),1)):(i(),d("span",xe,a(o(t)("games.auto.select-mode")),1)),T(o(Z),{size:16})])])]),k.value?(i(),d("div",ye,[e("div",fe,[e("span",be,a(o(t)("games.auto.current-status")),1),e("span",{class:z(["px-3 py-1 rounded-full text-xs font-medium",v.value===1?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"])},a(v.value===1?o(t)("games.auto.running"):o(t)("games.auto.closed")),3)])])):M("",!0),e("div",he,[e("div",we,a(o(t)("games.auto.settings-title")),1),e("div",ke,[e("p",null,a(o(t)("games.auto.instruction-1")),1),e("p",null,a(o(t)("games.auto.instruction-2")),1),e("p",null,a(o(t)("games.auto.instruction-3")),1),e("p",null,a(o(t)("games.auto.instruction-4")),1),e("p",null,a(o(t)("games.auto.instruction-5")),1)])])]),e("div",Ce,[e("div",Ie,[v.value===1?(i(),d("button",{key:0,onClick:n[4]||(n[4]=s=>V(0)),disabled:_.value,class:"flex-1 h-12 bg-gray-500 text-white rounded-lg hover:bg-gray-600 disabled:opacity-50"},a(_.value?o(t)("games.auto.processing"):o(t)("games.auto.stop")),9,Me)):(i(),d("button",{key:1,onClick:n[5]||(n[5]=s=>V(1)),disabled:_.value||!u.value,class:"flex-1 h-12 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50"},a(_.value?o(t)("games.auto.processing"):o(t)("games.auto.start")),9,Ne))])]),(i(),R(K,{to:"body"},[x.value?(i(),d("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",onClick:n[7]||(n[7]=O(s=>x.value=!1,["self"]))},[e("div",Se,[e("div",je,a(o(t)("games.play.select-mode")),1),e("div",qe,[p.value.length===0?(i(),d("div",Le,[e("p",null,a(o(t)("games.play.no-modes")),1),e("p",Ve,a(o(t)("games.play.create-mode-hint")),1)])):(i(),d("div",$e,[(i(!0),d(H,null,J(p.value,s=>(i(),d("button",{key:s.id,onClick:l=>B(s),class:z(["w-full px-4 py-3 text-left hover:bg-gray-50 flex justify-between items-center",u.value?.id===s.id&&"bg-red-50"])},[e("div",null,[e("div",ze,[e("span",null,a(s.mode_name),1),e("span",null,a(s.bet_gold),1)]),e("div",Ae,a(o(t)("games.mode.play-method"))+" "+a(s.bet_no),1),e("div",Be,a(o(t)("games.mode.coins"))+" "+a(s.bet_no_gold),1)]),u.value?.id===s.id?(i(),d("span",Ee,a(o(t)("common.selected")),1)):M("",!0)],10,Ge))),128))]))]),e("div",Ue,[e("button",{onClick:n[6]||(n[6]=s=>x.value=!1),class:"w-full py-2 bg-gray-200 text-gray-700 rounded-lg"},a(o(t)("games.play.close")),1)])])])):M("",!0)]))]))}});export{Je as default};
